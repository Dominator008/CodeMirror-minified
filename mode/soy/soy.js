'use strict';var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(c){var e=0;return function(){return e<c.length?{done:!1,value:c[e++]}:{done:!0}}};$jscomp.arrayIterator=function(c){return{next:$jscomp.arrayIteratorImpl(c)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,e,f){c!=Array.prototype&&c!=Object.prototype&&(c[e]=f.value)};$jscomp.getGlobal=function(c){c=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,c];for(var e=0;e<c.length;++e){var f=c[e];if(f&&f.Math==Math)return f}return globalThis};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(c,e){this.$jscomp$symbol$id_=c;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:e})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function c(f){if(this instanceof c)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(f||"")+"_"+e++,f)}var e=0;return c}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.iterator;c||(c=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[c]&&$jscomp.defineProperty(Array.prototype,c,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.asyncIterator;c||(c=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(c){$jscomp.initSymbolIterator();c={next:c};c[$jscomp.global.Symbol.iterator]=function(){return this};return c};
$jscomp.iteratorFromArray=function(c,e){$jscomp.initSymbolIterator();c instanceof String&&(c+="");var f=0,h={next:function(){if(f<c.length){var m=f++;return{value:e(m,c[m]),done:!1}}h.next=function(){return{done:!0,value:void 0}};return h.next()}};h[Symbol.iterator]=function(){return h};return h};
$jscomp.polyfill=function(c,e,f,h){if(e){f=$jscomp.global;c=c.split(".");for(h=0;h<c.length-1;h++){var m=c[h];m in f||(f[m]={});f=f[m]}c=c[c.length-1];h=f[c];e=e(h);e!=h&&null!=e&&$jscomp.defineProperty(f,c,{configurable:!0,writable:!0,value:e})}};$jscomp.polyfill("Array.prototype.keys",function(c){return c?c:function(){return $jscomp.iteratorFromArray(this,function(c){return c})}},"es6","es3");
(function(c){"object"==typeof exports&&"object"==typeof module?c(require("../../lib/codemirror"),require("../htmlmixed/htmlmixed")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../htmlmixed/htmlmixed"],c):c(CodeMirror)})(function(c){var e={noEndTag:!0,soyState:"param-def"},f={alias:{noEndTag:!0},delpackage:{noEndTag:!0},namespace:{noEndTag:!0,soyState:"namespace-def"},"@param":e,"@param?":e,"@inject":e,"@inject?":e,"@state":e,template:{soyState:"templ-def",variableScope:!0},
literal:{},msg:{},fallbackmsg:{noEndTag:!0,reduceIndent:!0},select:{},plural:{},let:{soyState:"var-def"},"if":{},elseif:{noEndTag:!0,reduceIndent:!0},"else":{noEndTag:!0,reduceIndent:!0},"switch":{},"case":{noEndTag:!0,reduceIndent:!0},"default":{noEndTag:!0,reduceIndent:!0},foreach:{variableScope:!0,soyState:"var-def"},ifempty:{noEndTag:!0,reduceIndent:!0},"for":{variableScope:!0,soyState:"var-def"},call:{soyState:"templ-ref"},param:{soyState:"param-ref"},print:{noEndTag:!0},deltemplate:{soyState:"templ-def",
variableScope:!0},delcall:{soyState:"templ-ref"},log:{},element:{variableScope:!0}},h=Object.keys(f).filter(function(c){return!f[c].noEndTag||f[c].reduceIndent});c.defineMode("soy",function(e){function l(b){return b[b.length-1]}function m(b,a,c){if(b.sol()){for(var d=0;d<a.indent&&b.eat(/\s/);d++);if(d)return null}d=b.string;if(c=c.exec(d.substr(b.pos)))b.string=d.substr(0,b.pos+c.index);c=b.hideFirstChars(a.indent,function(){var c=l(a.localStates);return c.mode.token(b,c.state)});b.string=d;return c}
function p(b,a){return{element:a,next:b}}function t(b){b.context&&(b.context.scope&&(b.variables=b.context.scope),b.context=b.context.previousContext)}function u(b,a,c){this.previousContext=b;this.tag=a;this.kind=null;this.scope=c}function q(b,a){var c;if(b.match(/[[]/))return a.soyState.push("list-literal"),a.lookupVariables=!1,null;if(b.match(/map\b/))return a.soyState.push("map-literal"),"keyword";if(b.match(/record\b/))return a.soyState.push("record-literal"),"keyword";if(b.match(/([\w]+)(?=\()/))return"variable callee";
if(c=b.match(/^["']/))return a.soyState.push("string"),a.quoteKind=c[0],"string";if(b.match(/^[(]/))return a.soyState.push("open-parentheses"),null;if(b.match(/(null|true|false)(?!\w)/)||b.match(/0x([0-9a-fA-F]{2,})/)||b.match(/-?([0-9]*[.])?[0-9]+(e[0-9]*)?/))return"atom";if(b.match(/(\||[+\-*\/%]|[=!]=|\?:|[<>]=?)/))return"operator";if(c=b.match(/^\$([\w]+)/)){b=!a.lookupVariables;a:{for(a=a.variables;a;){if(a.element===c[1]){c=!0;break a}a=a.next}c=!1}return c?"variable-2":b?"variable":"variable-2 error"}if(c=
b.match(/^\w+/))return/^(?:as|and|or|not|in|if)$/.test(c[0])?"keyword":null;b.next();return null}var n=c.getMode(e,"text/plain"),r={html:c.getMode(e,{name:"text/html",multilineTagIndentFactor:2,multilineTagIndentPastTag:!1}),attributes:n,text:n,uri:n,trusted_resource_uri:n,css:c.getMode(e,"text/css"),js:c.getMode(e,{name:"text/javascript",statementIndent:2*e.indentUnit})};return{startState:function(){return{soyState:[],variables:p(null,"ij"),scopes:null,indent:0,quoteKind:null,context:null,lookupVariables:!0,
localStates:[{mode:r.html,state:c.startState(r.html)}]}},copyState:function(b){return{tag:b.tag,soyState:b.soyState.concat([]),variables:b.variables,context:b.context,indent:b.indent,quoteKind:b.quoteKind,lookupVariables:b.lookupVariables,localStates:b.localStates.map(function(a){return{mode:a.mode,state:c.copyState(a.mode,a.state)}})}},token:function(b,a){var g;switch(l(a.soyState)){case "comment":b.match(/^.*?\*\//)?a.soyState.pop():b.skipToEnd();if(!a.context||!a.context.scope)for(var d=/@param\??\s+(\S+)/g,
k=b.current();g=d.exec(k);)a.variables=p(a.variables,g[1]);return"comment";case "string":return g=b.match(/^.*?(["']|\\[\s\S])/),g?g[1]==a.quoteKind&&(a.quoteKind=null,a.soyState.pop()):b.skipToEnd(),"string"}if(!a.soyState.length||"literal"!=l(a.soyState)){if(b.match(/^\/\*/))return a.soyState.push("comment"),"comment";if(b.match(b.sol()?/^\s*\/\/.*/:/^\s+\/\/.*/))return"comment"}switch(l(a.soyState)){case "templ-def":if(b.match(/^\.?([\w]+(?!\.[\w]+)*)/))return a.soyState.pop(),"def";b.next();return null;
case "templ-ref":if(g=b.match(/(\.?[a-zA-Z_][a-zA-Z_0-9]+)+/))return a.soyState.pop(),"."==g[0][0]?"variable-2":"variable";b.next();return null;case "namespace-def":if(b.match(/^\.?([\w\.]+)/))return a.soyState.pop(),"variable";b.next();return null;case "param-def":if(g=b.match(/^\w+/))return a.variables=p(a.variables,g[0]),a.soyState.pop(),a.soyState.push("param-type"),"def";b.next();return null;case "param-ref":if(b.match(/^\w+/))return a.soyState.pop(),"property";b.next();return null;case "open-parentheses":return b.match(/[)]/)?
(a.soyState.pop(),null):q(b,a);case "param-type":d=b.peek();if(-1!="}]=>,".indexOf(d))return a.soyState.pop(),null;if("["==d)return a.soyState.push("param-type-record"),null;if(g=b.match(/^([\w]+|[?])/))return"map"!=g[0]&&"list"!=g[0]||a.soyState.push("param-type-map-list"),"type";b.next();return null;case "param-type-record":d=b.peek();if("]"==d)return a.soyState.pop(),null;if(b.match(/^\w+/))return a.soyState.push("param-type"),"property";b.next();return null;case "param-type-map-list":b.peek();
if(b.match(/^[>]/))return a.soyState.pop(),null;if(b.match(/^[<,]/))return a.soyState.push("param-type"),null;b.next();return null;case "var-def":if(g=b.match(/^\$([\w]+)/))return a.variables=p(a.variables,g[1]),a.soyState.pop(),"def";b.next();return null;case "record-literal":if(b.match(/^[)]/))return a.soyState.pop(),null;if(b.match(/[(,]/))return a.soyState.push("map-value"),a.soyState.push("record-key"),null;b.next();return null;case "map-literal":if(b.match(/^[)]/))return a.soyState.pop(),null;
if(b.match(/[(,]/))return a.soyState.push("map-value"),a.soyState.push("map-value"),null;b.next();return null;case "list-literal":return b.match(/\]/)?(a.soyState.pop(),a.lookupVariables=!0,null):b.match(/for\b/)?(a.soyState.push("var-def"),"keyword"):b.match(/in\b/)?(a.lookupVariables=!0,"keyword"):q(b,a);case "record-key":if(b.match(/[\w]+/))return"property";if(b.match(/^[:]/))return a.soyState.pop(),null;b.next();return null;case "map-value":return")"==b.peek()||","==b.peek()||b.match(/^[:)]/)?
(a.soyState.pop(),null):q(b,a);case "tag":return k=(d="/"==a.tag[0])?a.tag.substring(1):a.tag,b.match(/^\/?}/)?((k="/}"==b.current())&&!d&&t(a),"/template"==a.tag||"/deltemplate"==a.tag?(a.variables=p(null,"ij"),a.indent=0):a.indent-=e.indentUnit*(k||-1==h.indexOf(a.tag)?2:1),a.soyState.pop(),"keyword"):b.match(/^([\w?]+)(?==)/)?(a.context&&a.context.tag==k&&"kind"==b.current()&&(g=b.match(/^="([^"]+)/,!1))&&(d=g[1],a.context.kind=d,k=r[d]||r.html,d=l(a.localStates),d.mode.indent&&(a.indent+=d.mode.indent(d.state,
"","")),a.localStates.push({mode:k,state:c.startState(k)})),"attribute"):q(b,a);case "literal":return b.match(/^(?=\{\/literal})/)?(a.soyState.pop(),this.token(b,a)):m(b,a,/\{\/literal}/)}if(b.match(/^\{literal}/))return a.indent+=e.indentUnit,a.soyState.push("literal"),a.context=new u(a.context,"literal",a.variables),"keyword";if(g=b.match(/^\{([/@\\]?\w+\??)(?=$|[\s}]|\/[/*])/)){b=a.tag;a.tag=g[1];d="/"==a.tag[0];var n=!!f[a.tag];k=d?a.tag.substring(1):a.tag;g=f[k];"/switch"!=a.tag&&(a.indent+=
((d||g&&g.reduceIndent)&&"switch"!=b?1:2)*e.indentUnit);a.soyState.push("tag");b=!1;g?(d||g.soyState&&a.soyState.push(g.soyState),g.noEndTag||!n&&d)?d&&(a.context&&a.context.tag==k?a.context&&(a.context.kind&&(a.localStates.pop(),d=l(a.localStates),d.mode.indent&&(a.indent-=d.mode.indent(d.state,"",""))),t(a)):b=!0):a.context=new u(a.context,a.tag,g.variableScope?a.variables:null):d&&(b=!0);return(b?"error ":"")+"keyword"}return b.eat("{")?(a.tag="print",a.indent+=2*e.indentUnit,a.soyState.push("tag"),
"keyword"):m(b,a,/\{|\s+\/\/|\/\*/)},indent:function(b,a,g){var d=b.indent,f=l(b.soyState);if("comment"==f)return c.Pass;if("literal"==f)/^\{\/literal}/.test(a)&&(d-=e.indentUnit);else{if(/^\s*\{\/(template|deltemplate)\b/.test(a))return 0;/^\{(\/|(fallbackmsg|elseif|else|ifempty)\b)/.test(a)&&(d-=e.indentUnit);"switch"!=b.tag&&/^\{(case|default)\b/.test(a)&&(d-=e.indentUnit);/^\{\/switch\b/.test(a)&&(d-=e.indentUnit)}b=l(b.localStates);d&&b.mode.indent&&(d+=b.mode.indent(b.state,a,g));return d},
innerMode:function(b){return b.soyState.length&&"literal"!=l(b.soyState)?null:l(b.localStates)},electricInput:/^\s*\{(\/|\/template|\/deltemplate|\/switch|fallbackmsg|elseif|else|case|default|ifempty|\/literal\})$/,lineComment:"//",blockCommentStart:"/*",blockCommentEnd:"*/",blockCommentContinue:" * ",useInnerComments:!1,fold:"indent"}},"htmlmixed");c.registerHelper("wordChars","soy",/[\w$]/);c.registerHelper("hintWords","soy",Object.keys(f).concat(["css","debugger"]));c.defineMIME("text/x-soy","soy")});
