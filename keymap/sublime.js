'use strict';var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(h,n,m){h instanceof String&&(h=String(h));for(var p=h.length,q=0;q<p;q++){var u=h[q];if(n.call(m,u,q,h))return{i:q,v:u}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(h,n,m){h!=Array.prototype&&h!=Object.prototype&&(h[n]=m.value)};
$jscomp.getGlobal=function(h){return"undefined"!=typeof window&&window===h?h:"undefined"!=typeof global&&null!=global?global:h};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(h,n,m,p){if(n){m=$jscomp.global;h=h.split(".");for(p=0;p<h.length-1;p++){var q=h[p];q in m||(m[q]={});m=m[q]}h=h[h.length-1];p=m[h];n=n(p);n!=p&&null!=n&&$jscomp.defineProperty(m,h,{configurable:!0,writable:!0,value:n})}};
$jscomp.polyfill("Array.prototype.find",function(h){return h?h:function(h,m){return $jscomp.findInternal(this,h,m).v}},"es6","es3");
(function(h){"object"==typeof exports&&"object"==typeof module?h(require("../lib/codemirror"),require("../addon/search/searchcursor"),require("../addon/edit/matchbrackets")):"function"==typeof define&&define.amd?define(["../lib/codemirror","../addon/search/searchcursor","../addon/edit/matchbrackets"],h):h(CodeMirror)})(function(h){function n(a,b){a.extendSelectionsBy(function(c){if(a.display.shift||a.doc.extend||c.empty()){var d=a.doc;c=c.head;if(0>b&&0==c.ch)var e=d.clipPos(l(c.line-1));else{var k=
d.getLine(c.line);if(0<b&&c.ch>=k.length)e=d.clipPos(l(c.line+1,0));else{d="start";for(var f=c.ch,g=0>b?0:k.length,t=0;f!=g;f+=b,t++){var v=k.charAt(0>b?f-1:f),r="_"!=v&&h.isWordChar(v)?"w":"o";"w"==r&&v.toUpperCase()==v&&(r="W");if("start"==d)"o"!=r&&(d="in",e=r);else if("in"==d&&e!=r)if("w"==e&&"W"==r&&0>b&&f--,"W"==e&&"w"==r&&0<b)e="w";else break}e=l(c.line,f)}}return e}return 0>b?c.from():c.to()})}function m(a,b){if(a.isReadOnly())return h.Pass;a.operation(function(){for(var c=a.listSelections().length,
d=[],e=-1,k=0;k<c;k++){var f=a.listSelections()[k].head;f.line<=e||(e=l(f.line+(b?0:1),0),a.replaceRange("\n",e,null,"+insertLine"),a.indentLine(e.line,null,!0),d.push({head:e,anchor:e}),e=f.line+1)}a.setSelections(d)});a.execCommand("indentAuto")}function p(a,b){var c=b.ch,d=c;for(a=a.getLine(b.line);c&&h.isWordChar(a.charAt(c-1));)--c;for(;d<a.length&&h.isWordChar(a.charAt(d));)++d;return{from:l(b.line,c),to:l(b.line,d),word:a.slice(c,d)}}function q(a,b){for(var c=a.listSelections(),d=[],e=0;e<
c.length;e++){var k=c[e],f=a.findPosV(k.anchor,b,"line"),h=a.findPosV(k.head,b,"line");f={anchor:f,head:h};d.push(k);d.push(f)}a.setSelections(d)}function u(a){for(var b=a.listSelections(),c=[],d=0;d<b.length;d++){var e=b[d],k=e.head,f=a.scanForBracket(k,-1);if(!f)return!1;for(;;){k=a.scanForBracket(k,1);if(!k)return!1;if(k.ch=="(){}[]".charAt("(){}[]".indexOf(f.ch)+1)){var g=l(f.pos.line,f.pos.ch+1);if(0==h.cmpPos(g,e.from())&&0==h.cmpPos(k.pos,e.to())){if(f=a.scanForBracket(f.pos,-1),!f)return!1}else{c.push({anchor:g,
head:k.pos});break}}k=l(k.pos.line,k.pos.ch+1)}}a.setSelections(c);return!0}function x(a,b){if(a.isReadOnly())return h.Pass;for(var c=a.listSelections(),d=[],e,k=0;k<c.length;k++){var f=c[k];if(!f.empty()){var g=f.from().line;for(f=f.to().line;k<c.length-1&&c[k+1].from().line==f;)f=c[++k].to().line;c[k].to().ch||f--;d.push(g,f)}}d.length?e=!0:d.push(a.firstLine(),a.lastLine());a.operation(function(){for(var c=[],f=0;f<d.length;f+=2){var k=d[f+1],h=l(d[f],0),g=l(k),w=a.getRange(h,g,!1);b?w.sort():
w.sort(function(a,c){var b=a.toUpperCase(),d=c.toUpperCase();b!=d&&(a=b,c=d);return a<c?-1:a==c?0:1});a.replaceRange(w,h,g);e&&c.push({anchor:h,head:l(k+1,0)})}e&&a.setSelections(c,0)})}function y(a,b){a.operation(function(){for(var c,d=a.listSelections(),e=[],k=[],f=0;f<d.length;f++)c=d[f],c.empty()?(e.push(f),k.push("")):k.push(b(a.getRange(c.from(),c.to())));a.replaceSelections(k,"around","case");f=e.length-1;for(var g;0<=f;f--)c=d[e[f]],g&&0<h.cmpPos(c.head,g)||(c=p(a,c.head),g=c.from,a.replaceRange(b(c.word),
c.from,c.to))})}function z(a){var b=a.getCursor("from"),c=a.getCursor("to");if(0==h.cmpPos(b,c)){var d=p(a,b);if(!d.word)return;b=d.from;c=d.to}return{from:b,to:c,query:a.getRange(b,c),word:d}}function A(a,b){var c=z(a);if(c){var d=c.query,e=a.getSearchCursor(d,b?c.to:c.from);(b?e.findNext():e.findPrevious())?a.setSelection(e.from(),e.to()):(e=a.getSearchCursor(d,b?l(a.firstLine(),0):a.clipPos(l(a.lastLine()))),(b?e.findNext():e.findPrevious())?a.setSelection(e.from(),e.to()):c.word&&a.setSelection(c.from,
c.to))}}var g=h.commands,l=h.Pos;g.goSubwordLeft=function(a){n(a,-1)};g.goSubwordRight=function(a){n(a,1)};g.scrollLineUp=function(a){var b=a.getScrollInfo();if(!a.somethingSelected()){var c=a.lineAtHeight(b.top+b.clientHeight,"local");a.getCursor().line>=c&&a.execCommand("goLineUp")}a.scrollTo(null,b.top-a.defaultTextHeight())};g.scrollLineDown=function(a){var b=a.getScrollInfo();if(!a.somethingSelected()){var c=a.lineAtHeight(b.top,"local")+1;a.getCursor().line<=c&&a.execCommand("goLineDown")}a.scrollTo(null,
b.top+a.defaultTextHeight())};g.splitSelectionByLine=function(a){for(var b=a.listSelections(),c=[],d=0;d<b.length;d++)for(var e=b[d].from(),k=b[d].to(),f=e.line;f<=k.line;++f)k.line>e.line&&f==k.line&&0==k.ch||c.push({anchor:f==e.line?e:l(f,0),head:f==k.line?k:l(f)});a.setSelections(c,0)};g.singleSelectionTop=function(a){var b=a.listSelections()[0];a.setSelection(b.anchor,b.head,{scroll:!1})};g.selectLine=function(a){for(var b=a.listSelections(),c=[],d=0;d<b.length;d++){var e=b[d];c.push({anchor:l(e.from().line,
0),head:l(e.to().line+1,0)})}a.setSelections(c)};g.insertLineAfter=function(a){return m(a,!1)};g.insertLineBefore=function(a){return m(a,!0)};g.selectNextOccurrence=function(a){var b=a.getCursor("from"),c=a.getCursor("to"),d=a.state.sublimeFindFullWord==a.doc.sel;if(0==h.cmpPos(b,c)){d=p(a,b);if(!d.word)return;a.setSelection(d.from,d.to);d=!0}else{b=a.getRange(b,c);b=d?new RegExp("\\b"+b+"\\b"):b;c=a.getSearchCursor(b,c);var e=c.findNext();e||(c=a.getSearchCursor(b,l(a.firstLine(),0)),e=c.findNext());
if(!(b=!e))a:{b=a.listSelections();e=c.from();for(var k=c.to(),f=0;f<b.length;f++)if(b[f].from()==e&&b[f].to()==k){b=!0;break a}b=!1}if(b)return h.Pass;a.addSelection(c.from(),c.to())}d&&(a.state.sublimeFindFullWord=a.doc.sel)};g.addCursorToPrevLine=function(a){q(a,-1)};g.addCursorToNextLine=function(a){q(a,1)};g.selectScope=function(a){u(a)||a.execCommand("selectAll")};g.selectBetweenBrackets=function(a){if(!u(a))return h.Pass};g.goToBracket=function(a){a.extendSelectionsBy(function(b){var c=a.scanForBracket(b.head,
1);return c&&0!=h.cmpPos(c.pos,b.head)?c.pos:(c=a.scanForBracket(b.head,-1))&&l(c.pos.line,c.pos.ch+1)||b.head})};g.swapLineUp=function(a){if(a.isReadOnly())return h.Pass;for(var b=a.listSelections(),c=[],d=a.firstLine()-1,e=[],k=0;k<b.length;k++){var f=b[k],g=f.from().line-1,t=f.to().line;e.push({anchor:l(f.anchor.line-1,f.anchor.ch),head:l(f.head.line-1,f.head.ch)});0!=f.to().ch||f.empty()||--t;g>d?c.push(g,t):c.length&&(c[c.length-1]=t);d=t}a.operation(function(){for(var b=0;b<c.length;b+=2){var d=
c[b],f=c[b+1],k=a.getLine(d);a.replaceRange("",l(d,0),l(d+1,0),"+swapLine");f>a.lastLine()?a.replaceRange("\n"+k,l(a.lastLine()),null,"+swapLine"):a.replaceRange(k+"\n",l(f,0),null,"+swapLine")}a.setSelections(e);a.scrollIntoView()})};g.swapLineDown=function(a){if(a.isReadOnly())return h.Pass;for(var b=a.listSelections(),c=[],d=a.lastLine()+1,e=b.length-1;0<=e;e--){var k=b[e],f=k.to().line+1,g=k.from().line;0!=k.to().ch||k.empty()||f--;f<d?c.push(f,g):c.length&&(c[c.length-1]=g);d=g}a.operation(function(){for(var b=
c.length-2;0<=b;b-=2){var d=c[b],f=c[b+1],e=a.getLine(d);d==a.lastLine()?a.replaceRange("",l(d-1),l(d),"+swapLine"):a.replaceRange("",l(d,0),l(d+1,0),"+swapLine");a.replaceRange(e+"\n",l(f,0),null,"+swapLine")}a.scrollIntoView()})};g.toggleCommentIndented=function(a){a.toggleComment({indent:!0})};g.joinLines=function(a){for(var b=a.listSelections(),c=[],d=0;d<b.length;d++){for(var e=b[d],k=e.from(),f=k.line,g=e.to().line;d<b.length-1&&b[d+1].from().line==g;)g=b[++d].to().line;c.push({start:f,end:g,
anchor:!e.empty()&&k})}a.operation(function(){for(var b=0,d=[],f=0;f<c.length;f++){for(var e=c[f],g=e.anchor&&l(e.anchor.line-b,e.anchor.ch),k,h=e.start;h<=e.end;h++){var m=h-b;h==e.end&&(k=l(m,a.getLine(m).length+1));m<a.lastLine()&&(a.replaceRange(" ",l(m),l(m+1,/^\s*/.exec(a.getLine(m+1))[0].length)),++b)}d.push({anchor:g||k,head:k})}a.setSelections(d,0)})};g.duplicateLine=function(a){a.operation(function(){for(var b=a.listSelections().length,c=0;c<b;c++){var d=a.listSelections()[c];d.empty()?
a.replaceRange(a.getLine(d.head.line)+"\n",l(d.head.line,0)):a.replaceRange(a.getRange(d.from(),d.to()),d.from())}a.scrollIntoView()})};g.sortLines=function(a){x(a,!0)};g.sortLinesInsensitive=function(a){x(a,!1)};g.nextBookmark=function(a){var b=a.state.sublimeBookmarks;if(b)for(;b.length;){var c=b.shift(),d=c.find();if(d)return b.push(c),a.setSelection(d.from,d.to)}};g.prevBookmark=function(a){var b=a.state.sublimeBookmarks;if(b)for(;b.length;){b.unshift(b.pop());var c=b[b.length-1].find();if(c)return a.setSelection(c.from,
c.to);b.pop()}};g.toggleBookmark=function(a){for(var b=a.listSelections(),c=a.state.sublimeBookmarks||(a.state.sublimeBookmarks=[]),d=0;d<b.length;d++){for(var e=b[d].from(),g=b[d].to(),f=a.findMarks(e,g),h=0;h<f.length;h++)if(f[h].sublimeBookmark){f[h].clear();for(var l=0;l<c.length;l++)c[l]==f[h]&&c.splice(l--,1);break}h==f.length&&c.push(a.markText(e,g,{sublimeBookmark:!0,clearWhenEmpty:!1}))}};g.clearBookmarks=function(a){if(a=a.state.sublimeBookmarks)for(var b=0;b<a.length;b++)a[b].clear();a.length=
0};g.selectBookmarks=function(a){var b=a.state.sublimeBookmarks,c=[];if(b)for(var d=0;d<b.length;d++){var e=b[d].find();e?c.push({anchor:e.from,head:e.to}):b.splice(d--,0)}c.length&&a.setSelections(c,0)};g.smartBackspace=function(a){if(a.somethingSelected())return h.Pass;a.operation(function(){for(var b=a.listSelections(),c=a.getOption("indentUnit"),d=b.length-1;0<=d;d--){var e=b[d].head,g=a.getRange({line:e.line,ch:0},e),f=h.countColumn(g,null,a.getOption("tabSize")),m=a.findPosH(e,-1,"char",!1);
g&&!/\S/.test(g)&&0==f%c&&(g=new l(e.line,h.findColumn(g,f-c,c)),g.ch!=e.ch&&(m=g));a.replaceRange("",m,e,"+delete")}})};g.delLineRight=function(a){a.operation(function(){for(var b=a.listSelections(),c=b.length-1;0<=c;c--)a.replaceRange("",b[c].anchor,l(b[c].to().line),"+delete");a.scrollIntoView()})};g.upcaseAtCursor=function(a){y(a,function(a){return a.toUpperCase()})};g.downcaseAtCursor=function(a){y(a,function(a){return a.toLowerCase()})};g.setSublimeMark=function(a){a.state.sublimeMark&&a.state.sublimeMark.clear();
a.state.sublimeMark=a.setBookmark(a.getCursor())};g.selectToSublimeMark=function(a){var b=a.state.sublimeMark&&a.state.sublimeMark.find();b&&a.setSelection(a.getCursor(),b)};g.deleteToSublimeMark=function(a){var b=a.state.sublimeMark&&a.state.sublimeMark.find();if(b){var c=a.getCursor();if(0<h.cmpPos(c,b)){var d=b;b=c;c=d}a.state.sublimeKilled=a.getRange(c,b);a.replaceRange("",c,b)}};g.swapWithSublimeMark=function(a){var b=a.state.sublimeMark&&a.state.sublimeMark.find();b&&(a.state.sublimeMark.clear(),
a.state.sublimeMark=a.setBookmark(a.getCursor()),a.setCursor(b))};g.sublimeYank=function(a){null!=a.state.sublimeKilled&&a.replaceSelection(a.state.sublimeKilled,null,"paste")};g.showInCenter=function(a){var b=a.cursorCoords(null,"local");a.scrollTo(null,(b.top+b.bottom)/2-a.getScrollInfo().clientHeight/2)};g.findUnder=function(a){A(a,!0)};g.findUnderPrevious=function(a){A(a,!1)};g.findAllUnder=function(a){var b=z(a);if(b){for(var c=a.getSearchCursor(b.query),d=[],e=-1;c.findNext();)d.push({anchor:c.from(),
head:c.to()}),c.from().line<=b.from.line&&c.from().ch<=b.from.ch&&e++;a.setSelections(d,e)}};g=h.keyMap;g.macSublime={"Cmd-Left":"goLineStartSmart","Shift-Tab":"indentLess","Shift-Ctrl-K":"deleteLine","Alt-Q":"wrapLines","Ctrl-Left":"goSubwordLeft","Ctrl-Right":"goSubwordRight","Ctrl-Alt-Up":"scrollLineUp","Ctrl-Alt-Down":"scrollLineDown","Cmd-L":"selectLine","Shift-Cmd-L":"splitSelectionByLine",Esc:"singleSelectionTop","Cmd-Enter":"insertLineAfter","Shift-Cmd-Enter":"insertLineBefore","Cmd-D":"selectNextOccurrence",
"Shift-Cmd-Space":"selectScope","Shift-Cmd-M":"selectBetweenBrackets","Cmd-M":"goToBracket","Cmd-Ctrl-Up":"swapLineUp","Cmd-Ctrl-Down":"swapLineDown","Cmd-/":"toggleCommentIndented","Cmd-J":"joinLines","Shift-Cmd-D":"duplicateLine",F9:"sortLines","Cmd-F9":"sortLinesInsensitive",F2:"nextBookmark","Shift-F2":"prevBookmark","Cmd-F2":"toggleBookmark","Shift-Cmd-F2":"clearBookmarks","Alt-F2":"selectBookmarks",Backspace:"smartBackspace","Cmd-K Cmd-K":"delLineRight","Cmd-K Cmd-U":"upcaseAtCursor","Cmd-K Cmd-L":"downcaseAtCursor",
"Cmd-K Cmd-Space":"setSublimeMark","Cmd-K Cmd-A":"selectToSublimeMark","Cmd-K Cmd-W":"deleteToSublimeMark","Cmd-K Cmd-X":"swapWithSublimeMark","Cmd-K Cmd-Y":"sublimeYank","Cmd-K Cmd-C":"showInCenter","Cmd-K Cmd-G":"clearBookmarks","Cmd-K Cmd-Backspace":"delLineLeft","Cmd-K Cmd-0":"unfoldAll","Cmd-K Cmd-J":"unfoldAll","Ctrl-Shift-Up":"addCursorToPrevLine","Ctrl-Shift-Down":"addCursorToNextLine","Cmd-F3":"findUnder","Shift-Cmd-F3":"findUnderPrevious","Alt-F3":"findAllUnder","Shift-Cmd-[":"fold","Shift-Cmd-]":"unfold",
"Cmd-I":"findIncremental","Shift-Cmd-I":"findIncrementalReverse","Cmd-H":"replace",F3:"findNext","Shift-F3":"findPrev",fallthrough:"macDefault"};h.normalizeKeyMap(g.macSublime);g.pcSublime={"Shift-Tab":"indentLess","Shift-Ctrl-K":"deleteLine","Alt-Q":"wrapLines","Ctrl-T":"transposeChars","Alt-Left":"goSubwordLeft","Alt-Right":"goSubwordRight","Ctrl-Up":"scrollLineUp","Ctrl-Down":"scrollLineDown","Ctrl-L":"selectLine","Shift-Ctrl-L":"splitSelectionByLine",Esc:"singleSelectionTop","Ctrl-Enter":"insertLineAfter",
"Shift-Ctrl-Enter":"insertLineBefore","Ctrl-D":"selectNextOccurrence","Shift-Ctrl-Space":"selectScope","Shift-Ctrl-M":"selectBetweenBrackets","Ctrl-M":"goToBracket","Shift-Ctrl-Up":"swapLineUp","Shift-Ctrl-Down":"swapLineDown","Ctrl-/":"toggleCommentIndented","Ctrl-J":"joinLines","Shift-Ctrl-D":"duplicateLine",F9:"sortLines","Ctrl-F9":"sortLinesInsensitive",F2:"nextBookmark","Shift-F2":"prevBookmark","Ctrl-F2":"toggleBookmark","Shift-Ctrl-F2":"clearBookmarks","Alt-F2":"selectBookmarks",Backspace:"smartBackspace",
"Ctrl-K Ctrl-K":"delLineRight","Ctrl-K Ctrl-U":"upcaseAtCursor","Ctrl-K Ctrl-L":"downcaseAtCursor","Ctrl-K Ctrl-Space":"setSublimeMark","Ctrl-K Ctrl-A":"selectToSublimeMark","Ctrl-K Ctrl-W":"deleteToSublimeMark","Ctrl-K Ctrl-X":"swapWithSublimeMark","Ctrl-K Ctrl-Y":"sublimeYank","Ctrl-K Ctrl-C":"showInCenter","Ctrl-K Ctrl-G":"clearBookmarks","Ctrl-K Ctrl-Backspace":"delLineLeft","Ctrl-K Ctrl-0":"unfoldAll","Ctrl-K Ctrl-J":"unfoldAll","Ctrl-Alt-Up":"addCursorToPrevLine","Ctrl-Alt-Down":"addCursorToNextLine",
"Ctrl-F3":"findUnder","Shift-Ctrl-F3":"findUnderPrevious","Alt-F3":"findAllUnder","Shift-Ctrl-[":"fold","Shift-Ctrl-]":"unfold","Ctrl-I":"findIncremental","Shift-Ctrl-I":"findIncrementalReverse","Ctrl-H":"replace",F3:"findNext","Shift-F3":"findPrev",fallthrough:"pcDefault"};h.normalizeKeyMap(g.pcSublime);g.sublime=g.default==g.macDefault?g.macSublime:g.pcSublime});
