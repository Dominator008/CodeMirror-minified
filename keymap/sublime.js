'use strict';var $jscomp={scope:{},findInternal:function(k,r,q){k instanceof String&&(k=String(k));for(var t=k.length,u=0;u<t;u++){var w=k[u];if(r.call(q,w,u,k))return{i:u,v:w}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(k,r,q){if(q.get||q.set)throw new TypeError("ES3 does not support getters and setters.");k!=Array.prototype&&k!=Object.prototype&&(k[r]=q.value)};
$jscomp.getGlobal=function(k){return"undefined"!=typeof window&&window===k?k:"undefined"!=typeof global&&null!=global?global:k};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(k,r,q,t){if(r){q=$jscomp.global;k=k.split(".");for(t=0;t<k.length-1;t++){var u=k[t];u in q||(q[u]={});q=q[u]}k=k[k.length-1];t=q[k];r=r(t);r!=t&&null!=r&&$jscomp.defineProperty(q,k,{configurable:!0,writable:!0,value:r})}};
$jscomp.polyfill("Array.prototype.find",function(k){return k?k:function(k,q){return $jscomp.findInternal(this,k,q).v}},"es6-impl","es3");
(function(k){"object"==typeof exports&&"object"==typeof module?k(require("../lib/codemirror"),require("../addon/search/searchcursor"),require("../addon/edit/matchbrackets")):"function"==typeof define&&define.amd?define(["../lib/codemirror","../addon/search/searchcursor","../addon/edit/matchbrackets"],k):k(CodeMirror)})(function(k){function r(a,b){a.extendSelectionsBy(function(c){if(a.display.shift||a.doc.extend||c.empty()){var d;var g=a.doc;c=c.head;if(0>b&&0==c.ch)d=g.clipPos(m(c.line-1));else{var p=
g.getLine(c.line);if(0<b&&c.ch>=p.length)d=g.clipPos(m(c.line+1,0));else{for(var g="start",h=c.ch,e=0>b?0:p.length,f=0;h!=e;h+=b,f++){var l=p.charAt(0>b?h-1:h),n="_"!=l&&k.isWordChar(l)?"w":"o";"w"==n&&l.toUpperCase()==l&&(n="W");if("start"==g)"o"!=n&&(g="in",d=n);else if("in"==g&&d!=n)if("w"==d&&"W"==n&&0>b&&h--,"W"==d&&"w"==n&&0<b)d="w";else break}d=m(c.line,h)}}return d}return 0>b?c.from():c.to()})}function q(a,b){if(a.isReadOnly())return k.Pass;a.operation(function(){for(var c=a.listSelections().length,
d=[],g=-1,p=0;p<c;p++){var h=a.listSelections()[p].head;h.line<=g||(g=m(h.line+(b?0:1),0),a.replaceRange("\n",g,null,"+insertLine"),a.indentLine(g.line,null,!0),d.push({head:g,anchor:g}),g=h.line+1)}a.setSelections(d)});a.execCommand("indentAuto")}function t(a,b){var c=b.ch,d=c;for(a=a.getLine(b.line);c&&k.isWordChar(a.charAt(c-1));)--c;for(;d<a.length&&k.isWordChar(a.charAt(d));)++d;return{from:m(b.line,c),to:m(b.line,d),word:a.slice(c,d)}}function u(a){for(var b=a.listSelections(),c=[],d=0;d<b.length;d++){var g=
b[d].head,p=a.scanForBracket(g,-1);if(!p)return!1;for(;;){g=a.scanForBracket(g,1);if(!g)return!1;if(g.ch=="(){}[]".charAt("(){}[]".indexOf(p.ch)+1)){c.push({anchor:m(p.pos.line,p.pos.ch+1),head:g.pos});break}g=m(g.pos.line,g.pos.ch+1)}}a.setSelections(c);return!0}function w(a,b){if(a.isReadOnly())return k.Pass;for(var c=a.listSelections(),d=[],g,p=0;p<c.length;p++){var h=c[p];if(!h.empty()){for(var e=h.from().line,h=h.to().line;p<c.length-1&&c[p+1].from().line==h;)h=c[++p].to().line;c[p].to().ch||
h--;d.push(e,h)}}d.length?g=!0:d.push(a.firstLine(),a.lastLine());a.operation(function(){for(var c=[],h=0;h<d.length;h+=2){var p=d[h+1],e=m(d[h],0),k=m(p),f=a.getRange(e,k,!1);b?f.sort():f.sort(function(a,b){var c=a.toUpperCase(),d=b.toUpperCase();c!=d&&(a=c,b=d);return a<b?-1:a==b?0:1});a.replaceRange(f,e,k);g&&c.push({anchor:e,head:m(p+1,0)})}g&&a.setSelections(c,0)})}function x(a,b){a.operation(function(){for(var c=a.listSelections(),d=[],g=[],e=0;e<c.length;e++){var h=c[e];h.empty()?(d.push(e),
g.push("")):g.push(b(a.getRange(h.from(),h.to())))}a.replaceSelections(g,"around","case");for(var e=d.length-1,f;0<=e;e--)h=c[d[e]],f&&0<k.cmpPos(h.head,f)||(g=t(a,h.head),f=g.from,a.replaceRange(b(g.word),g.from,g.to))})}function y(a){var b=a.getCursor("from"),c=a.getCursor("to");if(0==k.cmpPos(b,c)){var d=t(a,b);if(!d.word)return;b=d.from;c=d.to}return{from:b,to:c,query:a.getRange(b,c),word:d}}function z(a,b){var c=y(a);if(c){var d=c.query,g=a.getSearchCursor(d,b?c.to:c.from);(b?g.findNext():g.findPrevious())?
a.setSelection(g.from(),g.to()):(g=a.getSearchCursor(d,b?m(a.firstLine(),0):a.clipPos(m(a.lastLine()))),(b?g.findNext():g.findPrevious())?a.setSelection(g.from(),g.to()):c.word&&a.setSelection(c.from,c.to))}}var e=k.keyMap.sublime={fallthrough:"default"},f=k.commands,m=k.Pos,v=k.keyMap["default"]==k.keyMap.macDefault,l=v?"Cmd-":"Ctrl-",n=v?"Ctrl-":"Alt-";f[e[n+"Left"]="goSubwordLeft"]=function(a){r(a,-1)};f[e[n+"Right"]="goSubwordRight"]=function(a){r(a,1)};v&&(e["Cmd-Left"]="goLineStartSmart");n=
v?"Ctrl-Alt-":"Ctrl-";f[e[n+"Up"]="scrollLineUp"]=function(a){var b=a.getScrollInfo();if(!a.somethingSelected()){var c=a.lineAtHeight(b.top+b.clientHeight,"local");a.getCursor().line>=c&&a.execCommand("goLineUp")}a.scrollTo(null,b.top-a.defaultTextHeight())};f[e[n+"Down"]="scrollLineDown"]=function(a){var b=a.getScrollInfo();if(!a.somethingSelected()){var c=a.lineAtHeight(b.top,"local")+1;a.getCursor().line<=c&&a.execCommand("goLineDown")}a.scrollTo(null,b.top+a.defaultTextHeight())};f[e["Shift-"+
l+"L"]="splitSelectionByLine"]=function(a){for(var b=a.listSelections(),c=[],d=0;d<b.length;d++)for(var g=b[d].from(),e=b[d].to(),h=g.line;h<=e.line;++h)e.line>g.line&&h==e.line&&0==e.ch||c.push({anchor:h==g.line?g:m(h,0),head:h==e.line?e:m(h)});a.setSelections(c,0)};e["Shift-Tab"]="indentLess";f[e.Esc="singleSelectionTop"]=function(a){var b=a.listSelections()[0];a.setSelection(b.anchor,b.head,{scroll:!1})};f[e[l+"L"]="selectLine"]=function(a){for(var b=a.listSelections(),c=[],d=0;d<b.length;d++){var g=
b[d];c.push({anchor:m(g.from().line,0),head:m(g.to().line+1,0)})}a.setSelections(c)};e["Shift-Ctrl-K"]="deleteLine";f[e[l+"Enter"]="insertLineAfter"]=function(a){return q(a,!1)};f[e["Shift-"+l+"Enter"]="insertLineBefore"]=function(a){return q(a,!0)};f[e[l+"D"]="selectNextOccurrence"]=function(a){var b=a.getCursor("from"),c=a.getCursor("to"),d=a.state.sublimeFindFullWord==a.doc.sel;if(0==k.cmpPos(b,c)){d=t(a,b);if(!d.word)return;a.setSelection(d.from,d.to);d=!0}else{var b=a.getRange(b,c),b=d?new RegExp("\\b"+
b+"\\b"):b,c=a.getSearchCursor(b,c),g=c.findNext();g||(c=a.getSearchCursor(b,m(a.firstLine(),0)),g=c.findNext());if(!(b=!g))a:{for(var b=a.listSelections(),g=c.from(),e=c.to(),h=0;h<b.length;h++)if(b[h].from()==g&&b[h].to()==e){b=!0;break a}b=!1}if(b)return k.Pass;a.addSelection(c.from(),c.to())}d&&(a.state.sublimeFindFullWord=a.doc.sel)};f[e["Shift-"+l+"Space"]="selectScope"]=function(a){u(a)||a.execCommand("selectAll")};f[e["Shift-"+l+"M"]="selectBetweenBrackets"]=function(a){if(!u(a))return k.Pass};
f[e[l+"M"]="goToBracket"]=function(a){a.extendSelectionsBy(function(b){var c=a.scanForBracket(b.head,1);return c&&0!=k.cmpPos(c.pos,b.head)?c.pos:(c=a.scanForBracket(b.head,-1))&&m(c.pos.line,c.pos.ch+1)||b.head})};n=v?"Cmd-Ctrl-":"Shift-Ctrl-";f[e[n+"Up"]="swapLineUp"]=function(a){if(a.isReadOnly())return k.Pass;for(var b=a.listSelections(),c=[],d=a.firstLine()-1,g=[],e=0;e<b.length;e++){var h=b[e],f=h.from().line-1,l=h.to().line;g.push({anchor:m(h.anchor.line-1,h.anchor.ch),head:m(h.head.line-1,
h.head.ch)});0!=h.to().ch||h.empty()||--l;f>d?c.push(f,l):c.length&&(c[c.length-1]=l);d=l}a.operation(function(){for(var b=0;b<c.length;b+=2){var d=c[b],e=c[b+1],h=a.getLine(d);a.replaceRange("",m(d,0),m(d+1,0),"+swapLine");e>a.lastLine()?a.replaceRange("\n"+h,m(a.lastLine()),null,"+swapLine"):a.replaceRange(h+"\n",m(e,0),null,"+swapLine")}a.setSelections(g);a.scrollIntoView()})};f[e[n+"Down"]="swapLineDown"]=function(a){if(a.isReadOnly())return k.Pass;for(var b=a.listSelections(),c=[],d=a.lastLine()+
1,e=b.length-1;0<=e;e--){var f=b[e],h=f.to().line+1,l=f.from().line;0!=f.to().ch||f.empty()||h--;h<d?c.push(h,l):c.length&&(c[c.length-1]=l);d=l}a.operation(function(){for(var b=c.length-2;0<=b;b-=2){var d=c[b],e=c[b+1],g=a.getLine(d);d==a.lastLine()?a.replaceRange("",m(d-1),m(d),"+swapLine"):a.replaceRange("",m(d,0),m(d+1,0),"+swapLine");a.replaceRange(g+"\n",m(e,0),null,"+swapLine")}a.scrollIntoView()})};f[e[l+"/"]="toggleCommentIndented"]=function(a){a.toggleComment({indent:!0})};f[e[l+"J"]="joinLines"]=
function(a){for(var b=a.listSelections(),c=[],d=0;d<b.length;d++){for(var e=b[d],k=e.from(),h=k.line,f=e.to().line;d<b.length-1&&b[d+1].from().line==f;)f=b[++d].to().line;c.push({start:h,end:f,anchor:!e.empty()&&k})}a.operation(function(){for(var b=0,d=[],e=0;e<c.length;e++){for(var g=c[e],h=g.anchor&&m(g.anchor.line-b,g.anchor.ch),k,f=g.start;f<=g.end;f++){var l=f-b;f==g.end&&(k=m(l,a.getLine(l).length+1));l<a.lastLine()&&(a.replaceRange(" ",m(l),m(l+1,/^\s*/.exec(a.getLine(l+1))[0].length)),++b)}d.push({anchor:h||
k,head:k})}a.setSelections(d,0)})};f[e["Shift-"+l+"D"]="duplicateLine"]=function(a){a.operation(function(){for(var b=a.listSelections().length,c=0;c<b;c++){var d=a.listSelections()[c];d.empty()?a.replaceRange(a.getLine(d.head.line)+"\n",m(d.head.line,0)):a.replaceRange(a.getRange(d.from(),d.to()),d.from())}a.scrollIntoView()})};v||(e[l+"T"]="transposeChars");f[e.F9="sortLines"]=function(a){w(a,!0)};f[e[l+"F9"]="sortLinesInsensitive"]=function(a){w(a,!1)};f[e.F2="nextBookmark"]=function(a){var b=a.state.sublimeBookmarks;
if(b)for(;b.length;){var c=b.shift(),d=c.find();if(d)return b.push(c),a.setSelection(d.from,d.to)}};f[e["Shift-F2"]="prevBookmark"]=function(a){var b=a.state.sublimeBookmarks;if(b)for(;b.length;){b.unshift(b.pop());var c=b[b.length-1].find();if(c)return a.setSelection(c.from,c.to);b.pop()}};f[e[l+"F2"]="toggleBookmark"]=function(a){for(var b=a.listSelections(),c=a.state.sublimeBookmarks||(a.state.sublimeBookmarks=[]),d=0;d<b.length;d++){for(var e=b[d].from(),k=b[d].to(),h=a.findMarks(e,k),f=0;f<h.length;f++)if(h[f].sublimeBookmark){h[f].clear();
for(var l=0;l<c.length;l++)c[l]==h[f]&&c.splice(l--,1);break}f==h.length&&c.push(a.markText(e,k,{sublimeBookmark:!0,clearWhenEmpty:!1}))}};f[e["Shift-"+l+"F2"]="clearBookmarks"]=function(a){if(a=a.state.sublimeBookmarks)for(var b=0;b<a.length;b++)a[b].clear();a.length=0};f[e["Alt-F2"]="selectBookmarks"]=function(a){var b=a.state.sublimeBookmarks,c=[];if(b)for(var d=0;d<b.length;d++){var e=b[d].find();e?c.push({anchor:e.from,head:e.to}):b.splice(d--,0)}c.length&&a.setSelections(c,0)};e["Alt-Q"]="wrapLines";
n=l+"K ";e[n+l+"Backspace"]="delLineLeft";f[e.Backspace="smartBackspace"]=function(a){if(a.somethingSelected())return k.Pass;a.operation(function(){for(var b=a.listSelections(),c=a.getOption("indentUnit"),d=b.length-1;0<=d;d--){var e=b[d].head,f=a.getRange({line:e.line,ch:0},e),h=k.countColumn(f,null,a.getOption("tabSize")),l=a.findPosH(e,-1,"char",!1);f&&!/\S/.test(f)&&0==h%c&&(f=new m(e.line,k.findColumn(f,h-c,c)),f.ch!=e.ch&&(l=f));a.replaceRange("",l,e,"+delete")}})};f[e[n+l+"K"]="delLineRight"]=
function(a){a.operation(function(){for(var b=a.listSelections(),c=b.length-1;0<=c;c--)a.replaceRange("",b[c].anchor,m(b[c].to().line),"+delete");a.scrollIntoView()})};f[e[n+l+"U"]="upcaseAtCursor"]=function(a){x(a,function(a){return a.toUpperCase()})};f[e[n+l+"L"]="downcaseAtCursor"]=function(a){x(a,function(a){return a.toLowerCase()})};f[e[n+l+"Space"]="setSublimeMark"]=function(a){a.state.sublimeMark&&a.state.sublimeMark.clear();a.state.sublimeMark=a.setBookmark(a.getCursor())};f[e[n+l+"A"]="selectToSublimeMark"]=
function(a){var b=a.state.sublimeMark&&a.state.sublimeMark.find();b&&a.setSelection(a.getCursor(),b)};f[e[n+l+"W"]="deleteToSublimeMark"]=function(a){var b=a.state.sublimeMark&&a.state.sublimeMark.find();if(b){var c=a.getCursor();if(0<k.cmpPos(c,b))var d=b,b=c,c=d;a.state.sublimeKilled=a.getRange(c,b);a.replaceRange("",c,b)}};f[e[n+l+"X"]="swapWithSublimeMark"]=function(a){var b=a.state.sublimeMark&&a.state.sublimeMark.find();b&&(a.state.sublimeMark.clear(),a.state.sublimeMark=a.setBookmark(a.getCursor()),
a.setCursor(b))};f[e[n+l+"Y"]="sublimeYank"]=function(a){null!=a.state.sublimeKilled&&a.replaceSelection(a.state.sublimeKilled,null,"paste")};e[n+l+"G"]="clearBookmarks";f[e[n+l+"C"]="showInCenter"]=function(a){var b=a.cursorCoords(null,"local");a.scrollTo(null,(b.top+b.bottom)/2-a.getScrollInfo().clientHeight/2)};v=v?"Ctrl-Shift-":"Ctrl-Alt-";f[e[v+"Up"]="selectLinesUpward"]=function(a){a.operation(function(){for(var b=a.listSelections(),c=0;c<b.length;c++){var d=b[c];d.head.line>a.firstLine()&&
a.addSelection(m(d.head.line-1,d.head.ch))}})};f[e[v+"Down"]="selectLinesDownward"]=function(a){a.operation(function(){for(var b=a.listSelections(),c=0;c<b.length;c++){var d=b[c];d.head.line<a.lastLine()&&a.addSelection(m(d.head.line+1,d.head.ch))}})};f[e[l+"F3"]="findUnder"]=function(a){z(a,!0)};f[e["Shift-"+l+"F3"]="findUnderPrevious"]=function(a){z(a,!1)};f[e["Alt-F3"]="findAllUnder"]=function(a){var b=y(a);if(b){for(var c=a.getSearchCursor(b.query),d=[],e=-1;c.findNext();)d.push({anchor:c.from(),
head:c.to()}),c.from().line<=b.from.line&&c.from().ch<=b.from.ch&&e++;a.setSelections(d,e)}};e["Shift-"+l+"["]="fold";e["Shift-"+l+"]"]="unfold";e[n+l+"0"]=e[n+l+"J"]="unfoldAll";e[l+"I"]="findIncremental";e["Shift-"+l+"I"]="findIncrementalReverse";e[l+"H"]="replace";e.F3="findNext";e["Shift-F3"]="findPrev";k.normalizeKeyMap(e)});
