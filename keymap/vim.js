'use strict';var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(g,q,w){g instanceof String&&(g=String(g));for(var m=g.length,C=0;C<m;C++){var Q=g[C];if(q.call(w,Q,C,g))return{i:C,v:Q}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(g,q,w){g!=Array.prototype&&g!=Object.prototype&&(g[q]=w.value)};
$jscomp.getGlobal=function(g){return"undefined"!=typeof window&&window===g?g:"undefined"!=typeof global&&null!=global?global:g};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(g,q,w,m){if(q){w=$jscomp.global;g=g.split(".");for(m=0;m<g.length-1;m++){var C=g[m];C in w||(w[C]={});w=w[C]}g=g[g.length-1];m=w[g];q=q(m);q!=m&&null!=q&&$jscomp.defineProperty(w,g,{configurable:!0,writable:!0,value:q})}};
$jscomp.polyfill("Array.prototype.find",function(g){return g?g:function(g,w){return $jscomp.findInternal(this,g,w).v}},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var g=0;return function(q){return $jscomp.SYMBOL_PREFIX+(q||"")+g++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var g=$jscomp.global.Symbol.iterator;g||(g=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[g]&&$jscomp.defineProperty(Array.prototype,g,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(g){var q=0;return $jscomp.iteratorPrototype(function(){return q<g.length?{done:!1,value:g[q++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(g){$jscomp.initSymbolIterator();g={next:g};g[$jscomp.global.Symbol.iterator]=function(){return this};return g};$jscomp.iteratorFromArray=function(g,q){$jscomp.initSymbolIterator();g instanceof String&&(g+="");var w=0,m={next:function(){if(w<g.length){var C=w++;return{value:q(C,g[C]),done:!1}}m.next=function(){return{done:!0,value:void 0}};return m.next()}};m[Symbol.iterator]=function(){return m};return m};
$jscomp.polyfill("Array.prototype.keys",function(g){return g?g:function(){return $jscomp.iteratorFromArray(this,function(g){return g})}},"es6","es3");$jscomp.checkStringArgs=function(g,q,w){if(null==g)throw new TypeError("The 'this' value for String.prototype."+w+" must not be null or undefined");if(q instanceof RegExp)throw new TypeError("First argument to String.prototype."+w+" must not be a regular expression");return g+""};
$jscomp.polyfill("String.prototype.repeat",function(g){return g?g:function(g){var q=$jscomp.checkStringArgs(this,null,"repeat");if(0>g||1342177279<g)throw new RangeError("Invalid count value");g|=0;for(var m="";g;)if(g&1&&(m+=q),g>>>=1)q+=q;return m}},"es6","es3");
(function(g){"object"==typeof exports&&"object"==typeof module?g(require("../lib/codemirror"),require("../addon/search/searchcursor"),require("../addon/dialog/dialog"),require("../addon/edit/matchbrackets.js")):"function"==typeof define&&define.amd?define(["../lib/codemirror","../addon/search/searchcursor","../addon/dialog/dialog","../addon/edit/matchbrackets"],g):g(CodeMirror)})(function(g){var q=[{keys:"<Left>",type:"keyToKey",toKeys:"h"},{keys:"<Right>",type:"keyToKey",toKeys:"l"},{keys:"<Up>",
type:"keyToKey",toKeys:"k"},{keys:"<Down>",type:"keyToKey",toKeys:"j"},{keys:"<Space>",type:"keyToKey",toKeys:"l"},{keys:"<BS>",type:"keyToKey",toKeys:"h",context:"normal"},{keys:"<C-Space>",type:"keyToKey",toKeys:"W"},{keys:"<C-BS>",type:"keyToKey",toKeys:"B",context:"normal"},{keys:"<S-Space>",type:"keyToKey",toKeys:"w"},{keys:"<S-BS>",type:"keyToKey",toKeys:"b",context:"normal"},{keys:"<C-n>",type:"keyToKey",toKeys:"j"},{keys:"<C-p>",type:"keyToKey",toKeys:"k"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>"},
{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"s",type:"keyToKey",toKeys:"cl",context:"normal"},{keys:"s",type:"keyToKey",toKeys:"c",context:"visual"},{keys:"S",type:"keyToKey",toKeys:"cc",context:"normal"},{keys:"S",type:"keyToKey",toKeys:"VdO",context:"visual"},{keys:"<Home>",type:"keyToKey",toKeys:"0"},{keys:"<End>",type:"keyToKey",toKeys:"$"},{keys:"<PageUp>",type:"keyToKey",
toKeys:"<C-b>"},{keys:"<PageDown>",type:"keyToKey",toKeys:"<C-f>"},{keys:"<CR>",type:"keyToKey",toKeys:"j^",context:"normal"},{keys:"<Ins>",type:"action",action:"toggleOverwrite",context:"insert"},{keys:"H",type:"motion",motion:"moveToTopLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"M",type:"motion",motion:"moveToMiddleLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"L",type:"motion",motion:"moveToBottomLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"h",type:"motion",motion:"moveByCharacters",
motionArgs:{forward:!1}},{keys:"l",type:"motion",motion:"moveByCharacters",motionArgs:{forward:!0}},{keys:"j",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,linewise:!0}},{keys:"k",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,linewise:!0}},{keys:"gj",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!0}},{keys:"gk",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!1}},{keys:"w",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1}},
{keys:"W",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1,bigWord:!0}},{keys:"e",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,inclusive:!0}},{keys:"E",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"b",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1}},{keys:"B",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1,bigWord:!0}},{keys:"ge",type:"motion",motion:"moveByWords",
motionArgs:{forward:!1,wordEnd:!0,inclusive:!0}},{keys:"gE",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"{",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!1,toJumplist:!0}},{keys:"}",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!0,toJumplist:!0}},{keys:"<C-f>",type:"motion",motion:"moveByPage",motionArgs:{forward:!0}},{keys:"<C-b>",type:"motion",motion:"moveByPage",motionArgs:{forward:!1}},{keys:"<C-d>",type:"motion",
motion:"moveByScroll",motionArgs:{forward:!0,explicitRepeat:!0}},{keys:"<C-u>",type:"motion",motion:"moveByScroll",motionArgs:{forward:!1,explicitRepeat:!0}},{keys:"gg",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"G",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!0,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"0",type:"motion",motion:"moveToStartOfLine"},{keys:"^",type:"motion",motion:"moveToFirstNonWhiteSpaceCharacter"},
{keys:"+",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0}},{keys:"-",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,toFirstChar:!0}},{keys:"_",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0,repeatOffset:-1}},{keys:"$",type:"motion",motion:"moveToEol",motionArgs:{inclusive:!0}},{keys:"%",type:"motion",motion:"moveToMatchedSymbol",motionArgs:{inclusive:!0,toJumplist:!0}},{keys:"f<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!0,
inclusive:!0}},{keys:"F<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!1}},{keys:"t<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"T<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!1}},{keys:";",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!0}},{keys:",",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!1}},{keys:"'<character>",type:"motion",motion:"goToMark",
motionArgs:{toJumplist:!0,linewise:!0}},{keys:"`<character>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0}},{keys:"]`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0}},{keys:"[`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1}},{keys:"]'",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0,linewise:!0}},{keys:"['",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1,linewise:!0}},{keys:"]p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0,
matchIndent:!0}},{keys:"[p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0,matchIndent:!0}},{keys:"]<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!0,toJumplist:!0}},{keys:"[<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!1,toJumplist:!0}},{keys:"|",type:"motion",motion:"moveToColumn"},{keys:"o",type:"motion",motion:"moveToOtherHighlightedEnd",context:"visual"},{keys:"O",type:"motion",motion:"moveToOtherHighlightedEnd",motionArgs:{sameLine:!0},
context:"visual"},{keys:"d",type:"operator",operator:"delete"},{keys:"y",type:"operator",operator:"yank"},{keys:"c",type:"operator",operator:"change"},{keys:">",type:"operator",operator:"indent",operatorArgs:{indentRight:!0}},{keys:"<",type:"operator",operator:"indent",operatorArgs:{indentRight:!1}},{keys:"g~",type:"operator",operator:"changeCase"},{keys:"gu",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},isEdit:!0},{keys:"gU",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},
isEdit:!0},{keys:"n",type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:!0}},{keys:"N",type:"motion",motion:"findNext",motionArgs:{forward:!1,toJumplist:!0}},{keys:"x",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!0},operatorMotionArgs:{visualLine:!1}},{keys:"X",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!1},operatorMotionArgs:{visualLine:!0}},{keys:"D",type:"operatorMotion",operator:"delete",motion:"moveToEol",
motionArgs:{inclusive:!0},context:"normal"},{keys:"D",type:"operator",operator:"delete",operatorArgs:{linewise:!0},context:"visual"},{keys:"Y",type:"operatorMotion",operator:"yank",motion:"expandToLine",motionArgs:{linewise:!0},context:"normal"},{keys:"Y",type:"operator",operator:"yank",operatorArgs:{linewise:!0},context:"visual"},{keys:"C",type:"operatorMotion",operator:"change",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"C",type:"operator",operator:"change",operatorArgs:{linewise:!0},
context:"visual"},{keys:"~",type:"operatorMotion",operator:"changeCase",motion:"moveByCharacters",motionArgs:{forward:!0},operatorArgs:{shouldMoveCursor:!0},context:"normal"},{keys:"~",type:"operator",operator:"changeCase",context:"visual"},{keys:"<C-w>",type:"operatorMotion",operator:"delete",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1},context:"insert"},{keys:"<C-i>",type:"action",action:"jumpListWalk",actionArgs:{forward:!0}},{keys:"<C-o>",type:"action",action:"jumpListWalk",actionArgs:{forward:!1}},
{keys:"<C-e>",type:"action",action:"scroll",actionArgs:{forward:!0,linewise:!0}},{keys:"<C-y>",type:"action",action:"scroll",actionArgs:{forward:!1,linewise:!0}},{keys:"a",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"charAfter"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"eol"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"endOfSelectedArea"},context:"visual"},{keys:"i",
type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"inplace"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"firstNonBlank"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"startOfSelectedArea"},context:"visual"},{keys:"o",type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!0},context:"normal"},{keys:"O",type:"action",action:"newLineAndEnterInsertMode",
isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!1},context:"normal"},{keys:"v",type:"action",action:"toggleVisualMode"},{keys:"V",type:"action",action:"toggleVisualMode",actionArgs:{linewise:!0}},{keys:"<C-v>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"<C-q>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"gv",type:"action",action:"reselectLastSelection"},{keys:"J",type:"action",action:"joinLines",isEdit:!0},{keys:"p",type:"action",action:"paste",
isEdit:!0,actionArgs:{after:!0,isEdit:!0}},{keys:"P",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0}},{keys:"r<character>",type:"action",action:"replace",isEdit:!0},{keys:"@<character>",type:"action",action:"replayMacro"},{keys:"q<character>",type:"action",action:"enterMacroRecordMode"},{keys:"R",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{replace:!0}},{keys:"u",type:"action",action:"undo",context:"normal"},{keys:"u",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},
context:"visual",isEdit:!0},{keys:"U",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},context:"visual",isEdit:!0},{keys:"<C-r>",type:"action",action:"redo"},{keys:"m<character>",type:"action",action:"setMark"},{keys:'"<character>',type:"action",action:"setRegister"},{keys:"zz",type:"action",action:"scrollToCursor",actionArgs:{position:"center"}},{keys:"z.",type:"action",action:"scrollToCursor",actionArgs:{position:"center"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"zt",type:"action",
action:"scrollToCursor",actionArgs:{position:"top"}},{keys:"z<CR>",type:"action",action:"scrollToCursor",actionArgs:{position:"top"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"z-",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"}},{keys:"zb",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:".",type:"action",action:"repeatLastEdit"},{keys:"<C-a>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!0,
backtrack:!1}},{keys:"<C-x>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!1,backtrack:!1}},{keys:"<C-t>",type:"action",action:"indent",actionArgs:{indentRight:!0},context:"insert"},{keys:"<C-d>",type:"action",action:"indent",actionArgs:{indentRight:!1},context:"insert"},{keys:"a<character>",type:"motion",motion:"textObjectManipulation"},{keys:"i<character>",type:"motion",motion:"textObjectManipulation",motionArgs:{textObjectInner:!0}},{keys:"/",type:"search",searchArgs:{forward:!0,
querySrc:"prompt",toJumplist:!0}},{keys:"?",type:"search",searchArgs:{forward:!1,querySrc:"prompt",toJumplist:!0}},{keys:"*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"g*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:"g#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",toJumplist:!0}},
{keys:":",type:"ex"}],w=[{name:"colorscheme",shortName:"colo"},{name:"map"},{name:"imap",shortName:"im"},{name:"nmap",shortName:"nm"},{name:"vmap",shortName:"vm"},{name:"unmap"},{name:"write",shortName:"w"},{name:"undo",shortName:"u"},{name:"redo",shortName:"red"},{name:"set",shortName:"se"},{name:"set",shortName:"se"},{name:"setlocal",shortName:"setl"},{name:"setglobal",shortName:"setg"},{name:"sort",shortName:"sor"},{name:"substitute",shortName:"s",possiblyAsync:!0},{name:"nohlsearch",shortName:"noh"},
{name:"yank",shortName:"y"},{name:"delmarks",shortName:"delm"},{name:"registers",shortName:"reg",excludeFromCommandHistory:!0},{name:"global",shortName:"g"}],m=g.Pos;g.Vim=function(){function C(a,b){if(this==g.keyMap.vim&&(g.rmClass(a.getWrapperElement(),"cm-fat-cursor"),"contenteditable"==a.getOption("inputStyle")&&null!=document.body.style.caretColor)){var c=a.state.fatCursorMarks;if(c)for(var d=0;d<c.length;d++)c[d].clear();a.state.fatCursorMarks=null;a.off("cursorActivity",xa);a.getInputField().style.caretColor=
""}b&&b.attach==Q||(a.setOption("disableInput",!1),a.off("cursorActivity",ya),g.off(a.getInputField(),"paste",za(a)),a.state.vim=null)}function Q(a,b){this==g.keyMap.vim&&(g.addClass(a.getWrapperElement(),"cm-fat-cursor"),"contenteditable"==a.getOption("inputStyle")&&null!=document.body.style.caretColor&&(a.state.fatCursorMarks=Aa(a),a.on("cursorActivity",xa),a.getInputField().style.caretColor="transparent"));b&&b.attach==Q||(a.setOption("disableInput",!0),a.setOption("showCursorWhenSelecting",!1),
g.signal(a,"vim-mode-change",{mode:"normal"}),a.on("cursorActivity",ya),ba(a),g.on(a.getInputField(),"paste",za(a)))}function Aa(a){for(var b=a.listSelections(),c=[],d=0;d<b.length;d++){var e=b[d];if(e.empty())if(e.anchor.ch<a.getLine(e.anchor.line).length)c.push(a.markText(e.anchor,m(e.anchor.line,e.anchor.ch+1),{className:"cm-fat-cursor-mark"}));else{var f=document.createElement("span");f.textContent="\u00a0";f.className="cm-fat-cursor-mark";c.push(a.setBookmark(e.anchor,{widget:f}))}}return c}
function xa(a){var b=a.state.fatCursorMarks;if(b)for(var c=0;c<b.length;c++)b[c].clear();a.state.fatCursorMarks=Aa(a)}function ma(a,b){if(b){if(this[a])return this[a];a=lb(a);if(!a)return!1;var c=g.Vim.findKey(b,a);"function"==typeof c&&g.signal(b,"vim-keypress",a);return c}}function lb(a){if("'"==a.charAt(0))return a.charAt(1);a=a.split(/-(?!$)/);var b=a[a.length-1];if(1==a.length&&1==a[0].length||2==a.length&&"Shift"==a[0]&&1==b.length)return!1;for(var c=!1,d=0;d<a.length;d++){var e=a[d];e in Ba?
a[d]=Ba[e]:c=!0;e in Ca&&(a[d]=Ca[e])}if(!c)return!1;U(b)&&(a[a.length-1]=b.toLowerCase());return"<"+a.join("-")+">"}function za(a){var b=a.state.vim;b.onPasteFn||(b.onPasteFn=function(){b.insertMode||(a.setCursor(D(a.getCursor(),0,1)),ca.enterInsertMode(a,{},b))});return b.onPasteFn}function na(a,b){for(var c=[],d=a;d<a+b;d++)c.push(String.fromCharCode(d));return c}function Da(a,b){return b>=a.firstLine()&&b<=a.lastLine()}function U(a){return/^[A-Z]$/.test(a)}function oa(a,b){for(var c=0;c<b.length;c++)if(b[c]==
a)return!0;return!1}function da(a,b,c,d,e){if(void 0===b&&!e)throw Error("defaultValue is required unless callback is provided");c||(c="string");M[a]={type:c,defaultValue:b,callback:e};if(d)for(c=0;c<d.length;c++)M[d[c]]=M[a];b&&pa(a,b)}function pa(a,b,c,d){var e=M[a];d=d||{};d=d.scope;if(!e)return Error("Unknown option: "+a);if("boolean"==e.type){if(b&&!0!==b)return Error("Invalid argument: "+a+"="+b);!1!==b&&(b=!0)}e.callback?("local"!==d&&e.callback(b,void 0),"global"!==d&&c&&e.callback(b,c)):
("local"!==d&&(e.value="boolean"==e.type?!!b:b),"global"!==d&&c&&(c.state.vim.options[a]={value:b}))}function V(a,b,c){var d=M[a];c=c||{};c=c.scope;if(!d)return Error("Unknown option: "+a);if(d.callback){a=b&&d.callback(void 0,b);if("global"!==c&&void 0!==a)return a;if("local"!==c)return d.callback()}else return a="global"!==c&&b&&b.state.vim.options[a],(a||"local"!==c&&d||{}).value}function Ea(){this.latestRegister=void 0;this.isRecording=this.isPlaying=!1;this.replaySearchQueries=[];this.onRecordingDone=
void 0;this.lastInsertModeChanges=Fa()}function ba(a){a.state.vim||(a.state.vim={inputState:new ea,lastEditInputState:void 0,lastEditActionCommand:void 0,lastHPos:-1,lastHSPos:-1,lastMotion:null,marks:{},fakeCursor:null,insertMode:!1,insertModeRepeat:void 0,visualMode:!1,visualLine:!1,visualBlock:!1,lastSelection:null,lastPastedText:null,sel:{},options:{}});return a.state.vim}function Ga(){n={searchQuery:null,searchIsReversed:!1,lastSubstituteReplacePart:void 0,jumpList:mb(),macroModeState:new Ea,
lastCharacterSearch:{increment:0,forward:!0,selectedCharacter:""},registerController:new Ha({}),searchHistoryController:new qa,exCommandHistoryController:new qa};for(var a in M){var b=M[a];b.value=b.defaultValue}}function ea(){this.prefixRepeat=[];this.motionRepeat=[];this.motionArgs=this.motion=this.operatorArgs=this.operator=null;this.keyBuffer=[];this.registerName=null}function F(a,b){a.state.vim.inputState=new ea;g.signal(a,"vim-command-done",b)}function H(a,b,c){this.clear();this.keyBuffer=[a||
""];this.insertModeChanges=[];this.searchQueries=[];this.linewise=!!b;this.blockwise=!!c}function Ha(a){this.registers=a;this.unnamedRegister=a['"']=new H;a["."]=new H;a[":"]=new H;a["/"]=new H}function qa(){this.historyBuffer=[];this.iterator=0;this.initialPrefix=null}function Ia(a,b){for(var c=[],d=0;d<b;d++)c.push(a);return c}function E(a,b,c){var d=Math.min(Math.max(a.firstLine(),b.line),a.lastLine());a=B(a,d)-1;return m(d,Math.min(Math.max(0,b.ch),c?a+1:a))}function fa(a){var b={},c;for(c in a)a.hasOwnProperty(c)&&
(b[c]=a[c]);return b}function D(a,b,c){"object"===typeof b&&(c=b.ch,b=b.line);return m(a.line+b,a.ch+c)}function nb(a,b){return{line:b.line-a.line,ch:b.line-a.line}}function Ja(a,b,c){return function(){for(var d=0;d<c;d++)b(a)}}function A(a){return m(a.line,a.ch)}function I(a,b){return a.ch==b.ch&&a.line==b.line}function z(a,b){return a.line<b.line||a.line==b.line&&a.ch<b.ch?!0:!1}function G(a,b){2<arguments.length&&(b=G.apply(void 0,Array.prototype.slice.call(arguments,1)));return z(a,b)?a:b}function T(a,
b){2<arguments.length&&(b=T.apply(void 0,Array.prototype.slice.call(arguments,1)));return z(a,b)?b:a}function Ka(a,b,c){a=z(a,b);b=z(b,c);return a&&b}function B(a,b){return a.getLine(b).length}function ra(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function ob(a,b,c){var d=B(a,b);c=Array(c-d+1).join(" ");a.setCursor(m(b,d));a.replaceRange(c,a.getCursor())}function La(a,b){var c=[],d=a.listSelections(),e=A(a.clipPos(b)),f=!I(b,e),h;a:{var l=a.getCursor("head");for(h=0;h<d.length;h++){var k=
I(d[h].anchor,l),x=I(d[h].head,l);if(k||x)break a}h=-1}l=I(d[h].head,d[h].anchor);k=d.length-1;var g=k-h>h?k:0;h=d[g].anchor;var r=Math.min(h.line,e.line);k=Math.max(h.line,e.line);x=h.ch;e=e.ch;d=d[g].head.ch-x;g=e-x;0<d&&0>=g?(x++,f||e--):0>d&&0<=g?(x--,l||e++):0>d&&-1==g&&(x--,e++);for(f=r;f<=k;f++)d={anchor:new m(f,x),head:new m(f,e)},c.push(d);a.setSelections(c);b.ch=e;h.ch=x;return h}function Ma(a,b,c){for(var d=[],e=0;e<c;e++){var f=D(b,e,0);d.push({anchor:f,head:f})}a.setSelections(d,0)}function pb(a,
b){var c=b.lastSelection,d=function(){var b=a.getCursor(),d=a.getCursor(),h=c.visualBlock;if(h){d=m(b.line+h.height,b.ch+h.width);h=[];for(var l=b.line;l<d.line;l++){var k=m(l,b.ch),x=m(l,d.ch);h.push({anchor:k,head:x})}a.setSelections(h)}else l=c.anchorMark.find(),k=c.headMark.find(),h=k.line-l.line,l=k.ch-l.ch,d={line:d.line+h,ch:h?d.ch:l+d.ch},c.visualLine&&(b=m(b.line,0),d=m(d.line,B(a,d.line))),a.setSelection(b,d);return[b,d]};return b.visualMode?function(){var b=a.listSelections(),c=b[0];b=
b[b.length-1];c=z(c.anchor,c.head)?c.anchor:c.head;b=z(b.anchor,b.head)?b.head:b.anchor;return[c,b]}():d()}function Na(a,b){var c=b.sel.anchor,d=b.sel.head;b.lastPastedText&&(d=a.posFromIndex(a.indexFromPos(c)+b.lastPastedText.length),b.lastPastedText=null);b.lastSelection={anchorMark:a.setBookmark(c),headMark:a.setBookmark(d),anchor:A(c),head:A(d),visualMode:b.visualMode,visualLine:b.visualLine,visualBlock:b.visualBlock}}function W(a,b,c){var d=a.state.vim;b=b||d.sel;c=c||d.visualLine?"line":d.visualBlock?
"block":"char";b=sa(a,b,c);a.setSelections(b.ranges,b.primary);Oa(a)}function sa(a,b,c,d){var e=A(b.head),f=A(b.anchor);if("char"==c)return e=d||z(b.head,b.anchor)?0:1,f=z(b.head,b.anchor)?1:0,e=D(b.head,0,e),f=D(b.anchor,0,f),{ranges:[{anchor:f,head:e}],primary:0};if("line"==c)return z(b.head,b.anchor)?(e.ch=0,f.ch=B(a,f.line)):(f.ch=0,b=a.lastLine(),e.line>b&&(e.line=b),e.ch=B(a,e.line)),{ranges:[{anchor:f,head:e}],primary:0};if("block"==c){b=Math.min(f.line,e.line);a=Math.min(f.ch,e.ch);c=Math.max(f.ch,
e.ch)+1;f=Math.max(f.line,e.line)-b+1;e=e.line==b?0:f-1;d=[];for(var h=0;h<f;h++)d.push({anchor:m(b+h,a),head:m(b+h,c)});return{ranges:d,primary:e}}}function J(a,b){var c=a.state.vim;!1!==b&&a.setCursor(E(a,c.sel.head));Na(a,c);c.visualMode=!1;c.visualLine=!1;c.visualBlock=!1;g.signal(a,"vim-mode-change",{mode:"normal"});c.fakeCursor&&c.fakeCursor.clear()}function K(a){if(!a)return 0;var b=a.search(/\S/);return-1==b?a.length:b}function ha(a,b,c,d,e){c=a.getCursor("head");1==a.getSelection().length&&
(c=G(c,a.getCursor("anchor")));a=a.getLine(c.line);var f=c.ch;for(e=e?ia[0]:ta[0];!e(a.charAt(f));)if(f++,f>=a.length)return null;d?e=ta[0]:(e=ia[0],e(a.charAt(f))||(e=ia[1]));for(d=f;e(a.charAt(d))&&d<a.length;)d++;for(;e(a.charAt(f))&&0<=f;)f--;f++;if(b){for(b=d;/\s/.test(a.charAt(d))&&d<a.length;)d++;if(b==d){for(b=f;/\s/.test(a.charAt(f-1))&&0<f;)f--;f||(f=b)}}return{start:m(c.line,f),end:m(c.line,d)}}function Pa(a,b){n.lastCharacterSearch.increment=a;n.lastCharacterSearch.forward=b.forward;n.lastCharacterSearch.selectedCharacter=
b.selectedCharacter}function ua(a,b,c,d){for(var e=a.getCursor(),f=e.ch,h,l=0;l<b;l++){h=a.getLine(e.line);var k=d;h=c?h.indexOf(k,f+1):h.lastIndexOf(k,f-1);if(-1==h)return null;f=h}return m(a.getCursor().line,h)}function N(a,b,c,d){oa(c,qb)&&(b.marks[c]&&b.marks[c].clear(),b.marks[c]=a.setBookmark(d))}function Qa(a,b,c,d,e){function f(b,c,d){return d?!a.getLine(b)!=!a.getLine(b+c):!!a.getLine(b)&&!a.getLine(b+c)}b=b.line;var h=a.firstLine(),l=a.lastLine(),k=b;if(d){for(;h<=k&&k<=l&&0<c;)f(k,d)&&
c--,k+=d;return new m(k,0)}k=a.state.vim;k.visualLine&&f(b,1,!0)&&(k=k.sel.anchor,f(k.line,-1,!0)&&(e&&k.line==b||(b+=1)));d=!a.getLine(b);for(k=b;k<=l&&c;k++)f(k,1,!0)&&(e&&!a.getLine(k)==d||c--);c=new m(k,0);k>l&&!d?d=!0:e=!1;for(k=b;k>h&&(e&&!a.getLine(k)!=d&&k!=b||!f(k,-1,!0));k--);return{start:new m(k,0),end:c}}function Ra(){}function O(a){a=a.state.vim;return a.searchState_||(a.searchState_=new Ra)}function Sa(a){var b=Ta(a)||[];if(!b.length)return[];var c=[];if(0===b[0]){for(var d=0;d<b.length;d++)"number"==
typeof b[d]&&c.push(a.substring(b[d]+1,b[d+1]));return c}}function Ta(a){for(var b=!1,c=[],d=0;d<a.length;d++){var e=a.charAt(d);b||"/"!=e||c.push(d);b=!b&&"\\"==e}return c}function y(a,b){a.openNotification?a.openNotification('<span style="color: red">'+b+"</span>",{bottom:!0,duration:5E3}):alert(b)}function ja(a,b){var c=(b.prefix||"")+" "+(b.desc||""),d=b.desc,e='<span style="font-family: monospace; white-space: pre">'+(b.prefix||"")+'<input type="text"></span>';d&&(e+=' <span style="color: #888">'+
d+"</span>");d=b.onClose;a.openDialog?a.openDialog(e,d,{bottom:!0,value:b.value,onKeyDown:b.onKeyDown,onKeyUp:b.onKeyUp,selectValueOnOpen:!1}):d(prompt(c,""))}function X(a,b,c,d){if(b){var e=O(a);c=!!c;d=!!d;n.registerController.getRegister("/").setText(b);if(b instanceof RegExp)var f=b;else{var h=Ta(b);if(h.length){var l=b.substring(0,h[0]);f=-1!=b.substring(h[0]).indexOf("i")}else l=b;if(l){if(!V("pcre")){b=l;h=!1;l=[];for(var k=-1;k<b.length;k++){var x=b.charAt(k)||"",g=b.charAt(k+1)||"",m=g&&
-1!="|(){".indexOf(g);h?("\\"===x&&m||l.push(x),h=!1):"\\"===x?(h=!0,g&&-1!="}".indexOf(g)&&(m=!0),m&&"\\"!==g||l.push(x)):(l.push(x),m&&"\\"!==g&&l.push("\\"))}l=l.join("")}d&&(c=/^[^A-Z]*$/.test(l));f=new RegExp(l,c||f?"i":void 0)}else f=null}if(f){Ua(a,f);a:if(a=e.getQuery(),f instanceof RegExp&&a instanceof RegExp){c=["global","multiline","ignoreCase","source"];for(d=0;d<c.length;d++)if(b=c[d],f[b]!==a[b]){a=!1;break a}a=!0}else a=!1;if(a)return f;e.setQuery(f);return f}}}function rb(a){var b;
"^"==a.source.charAt(0)&&(b=!0);return{token:function(c){if(b&&!c.sol())c.skipToEnd();else{var d=c.match(a,!1);if(d){if(0==d[0].length)return c.next(),"searching";if(!c.sol()&&(c.backUp(1),!a.exec(c.next()+d[0])))return c.next(),null;c.match(a);return"searching"}for(;!c.eol()&&(c.next(),!c.match(a,!1)););}},query:a}}function Ua(a,b){var c=O(a),d=c.getOverlay();d&&b==d.query||(d&&a.removeOverlay(d),d=rb(b),a.addOverlay(d),a.showMatchesOnScrollbar&&(c.getScrollbarAnnotate()&&c.getScrollbarAnnotate().clear(),
c.setScrollbarAnnotate(a.showMatchesOnScrollbar(b))),c.setOverlay(d))}function Va(a,b,c,d){void 0===d&&(d=1);return a.operation(function(){for(var e=a.getCursor(),f=a.getSearchCursor(c,e),h=0;h<d;h++){var l=f.find(b);0==h&&l&&I(f.from(),e)&&(l=f.find(b));if(!l&&(f=a.getSearchCursor(c,b?m(a.lastLine()):m(a.firstLine(),0)),!f.find(b)))return}return f.from()})}function va(a){var b=O(a);a.removeOverlay(O(a).getOverlay());b.setOverlay(null);b.getScrollbarAnnotate()&&(b.getScrollbarAnnotate().clear(),b.setScrollbarAnnotate(null))}
function sb(a,b,c){"number"!=typeof a&&(a=a.line);return b instanceof Array?oa(a,b):c?a>=b&&a<=c:a==b}function wa(a){var b=a.getScrollInfo(),c=a.coordsChar({left:0,top:6+b.top},"local");a=a.coordsChar({left:0,top:b.clientHeight-10+b.top},"local");return{top:c.line,bottom:a.line}}function Wa(a,b,c){if("'"==c)return a=a.doc.history.done,(a=a[a.length-2])&&a.ranges&&a.ranges[0].head;if("."==c){if(0==a.doc.history.lastModTime)return;a=a.doc.history.done.filter(function(a){if(void 0!==a.changes)return a});
a.reverse();return a=a[0].changes[0].to}return(a=b.marks[c])&&a.find()}function tb(a,b,c,d,e,f,h,l,k){function x(){a.operation(function(){for(;!t;)m(),r();n()})}function m(){var b=a.getRange(f.from(),f.to()).replace(h,l);f.replace(b)}function r(){for(;f.findNext()&&sb(f.from(),d,e);)if(c||!p||f.from().line!=p.line){a.scrollIntoView(f.from(),30);a.setSelection(f.from(),f.to());p=f.from();t=!1;return}t=!0}function n(b){b&&b();a.focus();p&&(a.setCursor(p),b=a.state.vim,b.exMode=!1,b.lastHPos=b.lastHSPos=
p.ch);k&&k()}a.state.vim.exMode=!0;var t=!1,p=f.from();r();t?y(a,"No matches for "+h.source):b?ja(a,{prefix:"replace with <strong>"+l+"</strong> (y/n/a/q/l)",onKeyDown:function(b,c,d){g.e_stop(b);switch(g.keyName(b)){case "Y":m();r();break;case "N":r();break;case "A":b=k;k=void 0;a.operation(x);k=b;break;case "L":m();case "Q":case "Esc":case "Ctrl-C":case "Ctrl-[":n(d)}t&&n(d);return!0}}):(x(),k&&k())}function Y(a){var b=a.state.vim,c=n.macroModeState,d=n.registerController.getRegister("."),e=c.isPlaying,
f=c.lastInsertModeChanges;if(!e){var h=f.inVisualBlock&&b.lastSelection?b.lastSelection.visualBlock.height:1,l=f.changes;var k=[];for(var x=0;x<l.length;)k.push(l[x]),l[x]instanceof ka?x++:x+=h;f.changes=k;a.off("change",Xa);g.off(a.getInputField(),"keydown",Ya)}!e&&1<b.insertModeRepeat&&(Za(a,b,b.insertModeRepeat-1,!0),b.lastEditInputState.repeatOverride=b.insertModeRepeat);delete b.insertModeRepeat;b.insertMode=!1;a.setCursor(a.getCursor().line,a.getCursor().ch-1);a.setOption("keyMap","vim");a.setOption("disableInput",
!0);a.toggleOverwrite(!1);d.setText(f.changes.join(""));g.signal(a,"vim-mode-change",{mode:"normal"});c.isRecording&&(c.isPlaying||(a=n.registerController.getRegister(c.latestRegister))&&a.pushInsertModeChanges&&a.pushInsertModeChanges(c.lastInsertModeChanges))}function $a(a){q.unshift(a)}function Xa(a,b){var c=n.macroModeState,d=c.lastInsertModeChanges;if(!c.isPlaying)for(;b;){d.expectCursorActivityForChange=!0;if("+input"==b.origin||"paste"==b.origin||void 0===b.origin)c=b.text.join("\n"),d.maybeReset&&
(d.changes=[],d.maybeReset=!1),a.state.overwrite&&!/\n/.test(c)?d.changes.push([c]):d.changes.push(c);b=b.next}}function ya(a){var b=a.state.vim;if(b.insertMode){var c=n.macroModeState;if(c.isPlaying)return;c=c.lastInsertModeChanges;c.expectCursorActivityForChange?c.expectCursorActivityForChange=!1:c.maybeReset=!0}else if(!a.curOp.isVimOp){c=a.getCursor("anchor");var d=a.getCursor("head");b.visualMode&&!a.somethingSelected()?J(a,!1):b.visualMode||b.insertMode||!a.somethingSelected()||(b.visualMode=
!0,b.visualLine=!1,g.signal(a,"vim-mode-change",{mode:"visual"}));if(b.visualMode){var e=z(d,c)?0:-1,f=z(d,c)?-1:0;d=D(d,0,e);c=D(c,0,f);b.sel={anchor:c,head:d};N(a,b,"<",G(d,c));N(a,b,">",T(d,c))}else b.insertMode||(b.lastHPos=a.getCursor().ch)}b.visualMode&&Oa(a)}function Oa(a){var b=a.state.vim,c=E(a,A(b.sel.head)),d=D(c,0,1);b.fakeCursor&&b.fakeCursor.clear();b.fakeCursor=a.markText(c,d,{className:"cm-animate-fat-cursor"})}function ka(a){this.keyName=a}function Ya(a){function b(){c.maybeReset&&
(c.changes=[],c.maybeReset=!1);c.changes.push(new ka(d));return!0}var c=n.macroModeState.lastInsertModeChanges,d=g.keyName(a);d&&(-1==d.indexOf("Delete")&&-1==d.indexOf("Backspace")||g.lookupKey(d,"vim-insert",b))}function Za(a,b,c,d){function e(){l?R.processAction(a,b,b.lastEditActionCommand):R.evalInput(a,b)}function f(c){0<h.lastInsertModeChanges.changes.length&&(c=b.lastEditActionCommand?c:1,ab(a,h.lastInsertModeChanges.changes,c))}var h=n.macroModeState;h.isPlaying=!0;var l=!!b.lastEditActionCommand,
k=b.inputState;b.inputState=b.lastEditInputState;if(l&&b.lastEditActionCommand.interlaceInsertRepeat)for(var g=0;g<c;g++)e(),f(1);else d||e(),f(c);b.inputState=k;b.insertMode&&!d&&Y(a);h.isPlaying=!1}function ab(a,b,c){function d(b){if("string"==typeof b)g.commands[b](a);else b(a);return!0}var e=a.getCursor("head"),f=n.macroModeState.lastInsertModeChanges.inVisualBlock;f&&(c=a.state.vim.lastSelection,c=nb(c.anchor,c.head),Ma(a,e,c.line+1),c=a.listSelections().length,a.setCursor(e));for(var h=0;h<
c;h++){f&&a.setCursor(D(e,h,0));for(var l=0;l<b.length;l++){var k=b[l];if(k instanceof ka)g.lookupKey(k.keyName,"vim-insert",d);else if("string"==typeof k){var x=a.getCursor();a.replaceRange(k,x,x)}else{x=a.getCursor();var m=D(x,0,k[0].length);a.replaceRange(k[0],x,m)}}}f&&a.setCursor(D(e,0,1))}g.defineOption("vimMode",!1,function(a,b,c){b&&"vim"!=a.getOption("keyMap")?a.setOption("keyMap","vim"):!b&&c!=g.Init&&/^vim/.test(a.getOption("keyMap"))&&a.setOption("keyMap","default")});var Ba={Shift:"S",
Ctrl:"C",Alt:"A",Cmd:"D",Mod:"A"},Ca={Enter:"CR",Backspace:"BS",Delete:"Del",Insert:"Ins"},ub=/[\d]/,ia=[g.isWordChar,function(a){return a&&!g.isWordChar(a)&&!/\s/.test(a)}],ta=[function(a){return/\S/.test(a)}],bb=na(65,26),cb=na(97,26),db=na(48,10),qb=[].concat(bb,cb,db,["<",">"]),eb=[].concat(bb,cb,db,["-",'"',".",":","/"]),M={};da("filetype",void 0,"string",["ft"],function(a,b){if(void 0!==b){if(void 0===a)return a=b.getOption("mode"),"null"==a?"":a;b.setOption("mode",""==a?"null":a)}});var mb=
function(){var a=-1,b=0,c=0,d=Array(100);return{cachedCursor:void 0,add:function(e,f,h){function l(b){var c=++a%100,f=d[c];f&&f.clear();d[c]=e.setBookmark(b)}var k=d[a%100];k?(k=k.find())&&!I(k,f)&&l(f):l(f);l(h);b=a;c=a-100+1;0>c&&(c=0)},move:function(e,f){a+=f;a>b?a=b:a<c&&(a=c);var h=d[(100+a)%100];if(h&&!h.find()){f=0<f?1:-1;var l;e=e.getCursor();do if(a+=f,(h=d[(100+a)%100])&&(l=h.find())&&!I(e,l))break;while(a<b&&a>c)}return h}}},Fa=function(a){return a?{changes:a.changes,expectCursorActivityForChange:a.expectCursorActivityForChange}:
{changes:[],expectCursorActivityForChange:!1}};Ea.prototype={exitMacroRecordMode:function(){var a=n.macroModeState;if(a.onRecordingDone)a.onRecordingDone();a.onRecordingDone=void 0;a.isRecording=!1},enterMacroRecordMode:function(a,b){var c=n.registerController.getRegister(b);c&&(c.clear(),this.latestRegister=b,a.openDialog&&(this.onRecordingDone=a.openDialog("(recording)["+b+"]",null,{bottom:!0})),this.isRecording=!0)}};var n,Z,vb={buildKeyMap:function(){},getRegisterController:function(){return n.registerController},
resetVimGlobalState_:Ga,getVimGlobalState_:function(){return n},maybeInitVimState_:ba,suppressErrorLogging:!1,InsertModeKey:ka,map:function(a,b,c){L.map(a,b,c)},unmap:function(a,b){L.unmap(a,b)},setOption:pa,getOption:V,defineOption:da,defineEx:function(a,b,c){if(!b)b=a;else if(0!==a.indexOf(b))throw Error('(Vim.defineEx) "'+b+'" is not a prefix of "'+a+'", command not registered');fb[a]=c;L.commandMap_[b]={name:a,shortName:b,type:"api"}},handleKey:function(a,b,c){a=this.findKey(a,b,c);if("function"===
typeof a)return a()},findKey:function(a,b,c){function d(){if("<Esc>"==b)return F(a),h.visualMode?J(a):h.insertMode&&Y(a),!0}function e(){if(d())return!0;var c=h.inputState.keyBuffer+=b;for(var e=1==b.length,f=R.matchCommand(c,q,h.inputState,"insert");1<c.length&&"full"!=f.type;){c=h.inputState.keyBuffer=c.slice(1);var l=R.matchCommand(c,q,h.inputState,"insert");"none"!=l.type&&(f=l)}if("none"==f.type)return F(a),!1;if("partial"==f.type)return Z&&window.clearTimeout(Z),Z=window.setTimeout(function(){h.insertMode&&
h.inputState.keyBuffer&&F(a)},V("insertModeEscKeysTimeout")),!e;Z&&window.clearTimeout(Z);if(e){e=a.listSelections();for(l=0;l<e.length;l++){var g=e[l].head;a.replaceRange("",D(g,0,-(c.length-1)),g,"+input")}n.macroModeState.lastInsertModeChanges.changes.pop()}F(a);return f.command}function f(){a:{var e=n.macroModeState;if(e.isRecording){if("q"==b){e.exitMacroRecordMode();F(a);var f=!0;break a}"mapping"!=c&&(f=b,e.isPlaying||(e=n.registerController.getRegister(e.latestRegister))&&e.pushText(f))}f=
void 0}if(f||d())return!0;f=h.inputState.keyBuffer+=b;if(/^[1-9]\d*$/.test(f))return!0;e=/^(\d*)(.*)$/.exec(f);if(!e)return F(a),!1;var l=R.matchCommand(e[2]||e[1],q,h.inputState,h.visualMode?"visual":"normal");if("none"==l.type)return F(a),!1;if("partial"==l.type)return!0;h.inputState.keyBuffer="";e=/^(\d*)(.*)$/.exec(f);e[1]&&"0"!=e[1]&&h.inputState.pushRepeatDigit(e[1]);return l.command}var h=ba(a);var l=h.insertMode?e():f();if(!1!==l)return!0===l?function(){return!0}:function(){return a.operation(function(){a.curOp.isVimOp=
!0;try{if("keyToKey"==l.type)for(var c=l.toKeys,d;c;)d=/<\w+-.+?>|<\w+>|./.exec(c),b=d[0],c=c.substring(d.index+b.length),g.Vim.handleKey(a,b,"mapping");else R.processCommand(a,h,l)}catch(v){throw a.state.vim=void 0,ba(a),g.Vim.suppressErrorLogging||console.log(v),v;}return!0})}},handleEx:function(a,b){L.processCommand(a,b)},defineMotion:function(a,b){S[a]=b},defineAction:function(a,b){ca[a]=b},defineOperator:function(a,b){gb[a]=b},mapCommand:function(a,b,c,d,e){a={keys:a,type:b};a[b]=c;a[b+"Args"]=
d;for(var f in e)a[f]=e[f];$a(a)},_mapCommand:$a,defineRegister:function(a,b){var c=n.registerController.registers;if(!a||1!=a.length)throw Error("Register name must be 1 character");if(c[a])throw Error("Register already defined "+a);c[a]=b;eb.push(a)},exitVisualMode:J,exitInsertMode:Y};ea.prototype.pushRepeatDigit=function(a){this.operator?this.motionRepeat=this.motionRepeat.concat(a):this.prefixRepeat=this.prefixRepeat.concat(a)};ea.prototype.getRepeat=function(){var a=0;if(0<this.prefixRepeat.length||
0<this.motionRepeat.length)a=1,0<this.prefixRepeat.length&&(a*=parseInt(this.prefixRepeat.join(""),10)),0<this.motionRepeat.length&&(a*=parseInt(this.motionRepeat.join(""),10));return a};H.prototype={setText:function(a,b,c){this.keyBuffer=[a||""];this.linewise=!!b;this.blockwise=!!c},pushText:function(a,b){b&&(this.linewise||this.keyBuffer.push("\n"),this.linewise=!0);this.keyBuffer.push(a)},pushInsertModeChanges:function(a){this.insertModeChanges.push(Fa(a))},pushSearchQuery:function(a){this.searchQueries.push(a)},
clear:function(){this.keyBuffer=[];this.insertModeChanges=[];this.searchQueries=[];this.linewise=!1},toString:function(){return this.keyBuffer.join("")}};Ha.prototype={pushText:function(a,b,c,d,e){d&&"\n"!==c.charAt(c.length-1)&&(c+="\n");var f=this.isValidRegister(a)?this.getRegister(a):null;if(f)U(a)?f.pushText(c,d):f.setText(c,d,e),this.unnamedRegister.setText(f.toString(),d);else{switch(b){case "yank":this.registers["0"]=new H(c,d,e);break;case "delete":case "change":-1==c.indexOf("\n")?this.registers["-"]=
new H(c,d):(this.shiftNumericRegisters_(),this.registers["1"]=new H(c,d))}this.unnamedRegister.setText(c,d,e)}},getRegister:function(a){if(!this.isValidRegister(a))return this.unnamedRegister;a=a.toLowerCase();this.registers[a]||(this.registers[a]=new H);return this.registers[a]},isValidRegister:function(a){return a&&oa(a,eb)},shiftNumericRegisters_:function(){for(var a=9;2<=a;a--)this.registers[a]=this.getRegister(""+(a-1))}};qa.prototype={nextMatch:function(a,b){var c=this.historyBuffer,d=b?-1:
1;null===this.initialPrefix&&(this.initialPrefix=a);for(var e=this.iterator+d;b?0<=e:e<c.length;e+=d)for(var f=c[e],h=0;h<=f.length;h++)if(this.initialPrefix==f.substring(0,h))return this.iterator=e,f;if(e>=c.length)return this.iterator=c.length,this.initialPrefix;if(0>e)return a},pushInput:function(a){var b=this.historyBuffer.indexOf(a);-1<b&&this.historyBuffer.splice(b,1);a.length&&this.historyBuffer.push(a)},reset:function(){this.initialPrefix=null;this.iterator=this.historyBuffer.length}};var R=
{matchCommand:function(a,b,c,d){var e=[];var f=[];for(var h=0;h<b.length;h++){var l=b[h],k;if(k=!("insert"==d&&"insert"!=l.context||l.context&&l.context!=d||c.operator&&"action"==l.type)){var g=a;var m=l.keys;if("<character>"==m.slice(-11)){k=m.length-11;var n=g.slice(0,k);m=m.slice(0,k);g=n==m&&g.length>k?"full":0==m.indexOf(n)?"partial":!1}else g=g==m?"full":0==m.indexOf(g)?"partial":!1;k=g}k&&("partial"==g&&e.push(l),"full"==g&&f.push(l))}b=e.length&&e;f=f.length&&f;if(!f&&!b)return{type:"none"};
if(!f&&b)return{type:"partial"};var u;for(b=0;b<f.length;b++)d=f[b],u||(u=d);if("<character>"==u.keys.slice(-11)){a=(f=/^.*(<[^>]+>)$/.exec(a))?f[1]:a.slice(-1);if(1<a.length)switch(a){case "<CR>":a="\n";break;case "<Space>":a=" ";break;default:a=""}if(!a)return{type:"none"};c.selectedCharacter=a}return{type:"full",command:u}},processCommand:function(a,b,c){b.inputState.repeatOverride=c.repeatOverride;switch(c.type){case "motion":this.processMotion(a,b,c);break;case "operator":this.processOperator(a,
b,c);break;case "operatorMotion":this.processOperatorMotion(a,b,c);break;case "action":this.processAction(a,b,c);break;case "search":this.processSearch(a,b,c);break;case "ex":case "keyToEx":this.processEx(a,b,c)}},processMotion:function(a,b,c){b.inputState.motion=c.motion;b.inputState.motionArgs=fa(c.motionArgs);this.evalInput(a,b)},processOperator:function(a,b,c){var d=b.inputState;if(d.operator){if(d.operator==c.operator){d.motion="expandToLine";d.motionArgs={linewise:!0};this.evalInput(a,b);return}F(a)}d.operator=
c.operator;d.operatorArgs=fa(c.operatorArgs);b.visualMode&&this.evalInput(a,b)},processOperatorMotion:function(a,b,c){var d=b.visualMode,e=fa(c.operatorMotionArgs);e&&d&&e.visualLine&&(b.visualLine=!0);this.processOperator(a,b,c);d||this.processMotion(a,b,c)},processAction:function(a,b,c){var d=b.inputState,e=d.getRepeat(),f=!!e,h=fa(c.actionArgs)||{};d.selectedCharacter&&(h.selectedCharacter=d.selectedCharacter);c.operator&&this.processOperator(a,b,c);c.motion&&this.processMotion(a,b,c);(c.motion||
c.operator)&&this.evalInput(a,b);h.repeat=e||1;h.repeatIsExplicit=f;h.registerName=d.registerName;F(a);b.lastMotion=null;c.isEdit&&this.recordLastEdit(b,d,c);ca[c.action](a,h,b)},processSearch:function(a,b,c){function d(d,e,f){n.searchHistoryController.pushInput(d);n.searchHistoryController.reset();try{X(a,d,e,f)}catch(yb){y(a,"Invalid regex: "+d);F(a);return}R.processMotion(a,b,{type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:c.searchArgs.toJumplist}})}function e(b){a.scrollTo(r.left,
r.top);d(b,!0,!0);var c=n.macroModeState;c.isRecording&&(c.isPlaying||(c=n.registerController.getRegister(c.latestRegister))&&c.pushSearchQuery&&c.pushSearchQuery(b))}function f(b,c,d){var e=g.keyName(b);if("Up"==e||"Down"==e){var f=b.target?b.target.selectionEnd:0;c=n.searchHistoryController.nextMatch(c,"Up"==e?!0:!1)||"";d(c);f&&b.target&&(b.target.selectionEnd=b.target.selectionStart=Math.min(f,b.target.value.length))}else"Left"!=e&&"Right"!=e&&"Ctrl"!=e&&"Alt"!=e&&"Shift"!=e&&n.searchHistoryController.reset();
try{var h=X(a,c,!0,!0)}catch(la){}h?a.scrollIntoView(Va(a,!l,h),30):(va(a),a.scrollTo(r.left,r.top))}function h(b,c,d){var e=g.keyName(b);"Esc"==e||"Ctrl-C"==e||"Ctrl-["==e||"Backspace"==e&&""==c?(n.searchHistoryController.pushInput(c),n.searchHistoryController.reset(),X(a,v),va(a),a.scrollTo(r.left,r.top),g.e_stop(b),F(a),d(),a.focus()):"Up"==e||"Down"==e?g.e_stop(b):"Ctrl-U"==e&&(g.e_stop(b),d(""))}if(a.getSearchCursor){var l=c.searchArgs.forward,k=c.searchArgs.wholeWordOnly;O(a).setReversed(!l);
var m=l?"/":"?";var v=O(a).getQuery(),r=a.getScrollInfo();switch(c.searchArgs.querySrc){case "prompt":k=n.macroModeState;k.isPlaying?(m=k.replaySearchQueries.shift(),d(m,!0,!1)):ja(a,{onClose:e,prefix:m,desc:wb,onKeyUp:f,onKeyDown:h});break;case "wordUnderCursor":var u=ha(a,!1,!0,!1,!0),t=!0;u||(u=ha(a,!1,!0,!1,!1),t=!1);u&&(m=a.getLine(u.start.line).substring(u.start.ch,u.end.ch),m=t&&k?"\\b"+m+"\\b":m.replace(/([.?*+$\[\]\/\\(){}|\-])/g,"\\$1"),n.jumpList.cachedCursor=a.getCursor(),a.setCursor(u.start),
d(m,!0,!1))}}},processEx:function(a,b,c){function d(b){n.exCommandHistoryController.pushInput(b);n.exCommandHistoryController.reset();L.processCommand(a,b)}function e(b,c,d){var e=g.keyName(b);if("Esc"==e||"Ctrl-C"==e||"Ctrl-["==e||"Backspace"==e&&""==c)n.exCommandHistoryController.pushInput(c),n.exCommandHistoryController.reset(),g.e_stop(b),F(a),d(),a.focus();if("Up"==e||"Down"==e){g.e_stop(b);var f=b.target?b.target.selectionEnd:0;c=n.exCommandHistoryController.nextMatch(c,"Up"==e?!0:!1)||"";d(c);
f&&b.target&&(b.target.selectionEnd=b.target.selectionStart=Math.min(f,b.target.value.length))}else"Ctrl-U"==e?(g.e_stop(b),d("")):"Left"!=e&&"Right"!=e&&"Ctrl"!=e&&"Alt"!=e&&"Shift"!=e&&n.exCommandHistoryController.reset()}"keyToEx"==c.type?L.processCommand(a,c.exArgs.input):b.visualMode?ja(a,{onClose:d,prefix:":",value:"'<,'>",onKeyDown:e}):ja(a,{onClose:d,prefix:":",onKeyDown:e})},evalInput:function(a,b){var c=b.inputState,d=c.motion,e=c.motionArgs||{},f=c.operator,h=c.operatorArgs||{},l=c.registerName,
k=b.sel,g=A(b.visualMode?E(a,k.head):a.getCursor("head")),v=A(b.visualMode?E(a,k.anchor):a.getCursor("anchor")),r=A(g);v=A(v);f&&this.recordLastEdit(b,c);var u=void 0!==c.repeatOverride?c.repeatOverride:c.getRepeat();if(0<u&&e.explicitRepeat)e.repeatIsExplicit=!0;else if(e.noRepeat||!e.explicitRepeat&&0===u)u=1,e.repeatIsExplicit=!1;c.selectedCharacter&&(e.selectedCharacter=h.selectedCharacter=c.selectedCharacter);e.repeat=u;F(a);if(d){var t=S[d](a,g,e,b);b.lastMotion=S[d];if(!t)return;e.toJumplist&&
(d=n.jumpList,(c=d.cachedCursor)?(I(c,t)||n.jumpList.add(a,c,t),delete d.cachedCursor):I(g,t)||n.jumpList.add(a,g,t));if(t instanceof Array){var p=t[0];t=t[1]}t||(t=A(g));b.visualMode?(b.visualBlock&&Infinity===t.ch||(t=E(a,t,b.visualBlock)),p&&(p=E(a,p,!0)),p=p||v,k.anchor=p,k.head=t,W(a),N(a,b,"<",z(p,t)?p:t),N(a,b,">",z(p,t)?t:p)):f||(t=E(a,t),a.setCursor(t.line,t.ch))}if(f){h.lastSel?(p=v,k=h.lastSel,t=Math.abs(k.head.line-k.anchor.line),g=Math.abs(k.head.ch-k.anchor.ch),t=k.visualLine?m(v.line+
t,v.ch):k.visualBlock?m(v.line+t,v.ch+g):k.head.line==k.anchor.line?m(v.line,v.ch+g):m(v.line+t,v.ch),b.visualMode=!0,b.visualLine=k.visualLine,b.visualBlock=k.visualBlock,k=b.sel={anchor:p,head:t},W(a)):b.visualMode&&(h.lastSel={anchor:A(k.anchor),head:A(k.head),visualBlock:b.visualBlock,visualLine:b.visualLine});if(b.visualMode){if(p=G(k.head,k.anchor),k=T(k.head,k.anchor),r=b.visualLine||h.linewise,e=b.visualBlock?"block":r?"line":"char",p=sa(a,{anchor:p,head:k},e),r)if(k=p.ranges,"block"==e)for(e=
0;e<k.length;e++)k[e].head.ch=B(a,k[e].head.line);else"line"==e&&(k[0].head=m(k[0].head.line+1,0))}else{p=A(p||v);k=A(t||r);z(k,p)&&(r=p,p=k,k=r);if(r=e.linewise||h.linewise)g=k,p.ch=0,g.ch=0,g.line++;else if(e.forward&&(g=k,d=a.getRange(p,g),/\n\s*$/.test(d))){d=d.split("\n");d.pop();for(c=d.pop();0<d.length&&c&&/^\s*$/.test(c);c=d.pop())g.line--,g.ch=0;c?(g.line--,g.ch=B(a,g.line)):g.ch=0}p=sa(a,{anchor:p,head:k},"char",!e.inclusive||r)}a.setSelections(p.ranges,p.primary);b.lastMotion=null;h.repeat=
u;h.registerName=l;h.linewise=r;f=gb[f](a,h,p.ranges,v,t);b.visualMode&&J(a,null!=f);f&&a.setCursor(f)}},recordLastEdit:function(a,b,c){var d=n.macroModeState;d.isPlaying||(a.lastEditInputState=b,a.lastEditActionCommand=c,d.lastInsertModeChanges.changes=[],d.lastInsertModeChanges.expectCursorActivityForChange=!1)}},S={moveToTopLine:function(a,b,c){b=wa(a).top+c.repeat-1;return m(b,K(a.getLine(b)))},moveToMiddleLine:function(a){var b=wa(a);b=Math.floor(.5*(b.top+b.bottom));return m(b,K(a.getLine(b)))},
moveToBottomLine:function(a,b,c){b=wa(a).bottom-c.repeat+1;return m(b,K(a.getLine(b)))},expandToLine:function(a,b,c){return m(b.line+c.repeat-1,Infinity)},findNext:function(a,b,c){b=O(a);var d=b.getQuery();if(d){var e=!c.forward;e=b.isReversed()?!e:e;Ua(a,d);return Va(a,e,d,c.repeat)}},goToMark:function(a,b,c,d){return(b=Wa(a,d,c.selectedCharacter))?c.linewise?{line:b.line,ch:K(a.getLine(b.line))}:b:null},moveToOtherHighlightedEnd:function(a,b,c,d){return d.visualBlock&&c.sameLine?(b=d.sel,[E(a,m(b.anchor.line,
b.head.ch)),E(a,m(b.head.line,b.anchor.ch))]):[d.sel.head,d.sel.anchor]},jumpToMark:function(a,b,c,d){for(var e=0;e<c.repeat;e++){var f=b,h;for(h in d.marks)if(/^[a-z]$/.test(h)){var l=d.marks[h].find();if(c.forward?!z(l,f):!z(f,l))if(!c.linewise||l.line!=f.line){var k=I(f,b),g=c.forward?Ka(f,l,b):Ka(b,l,f);if(k||g)b=l}}}c.linewise&&(b=m(b.line,K(a.getLine(b.line))));return b},moveByCharacters:function(a,b,c){a=c.repeat;return m(b.line,c.forward?b.ch+a:b.ch-a)},moveByLines:function(a,b,c,d){var e=
b.ch;switch(d.lastMotion){case this.moveByLines:case this.moveByDisplayLines:case this.moveByScroll:case this.moveToColumn:case this.moveToEol:e=d.lastHPos;break;default:d.lastHPos=e}var f=c.repeat+(c.repeatOffset||0);f=c.forward?b.line+f:b.line-f;var h=a.firstLine(),l=a.lastLine();if(f<h&&b.line==h)return this.moveToStartOfLine(a,b,c,d);if(f>l&&b.line==l)return this.moveToEol(a,b,c,d);c.toFirstChar&&(e=K(a.getLine(f)),d.lastHPos=e);d.lastHSPos=a.charCoords(m(f,e),"div").left;return m(f,e)},moveByDisplayLines:function(a,
b,c,d){switch(d.lastMotion){case this.moveByDisplayLines:case this.moveByScroll:case this.moveByLines:case this.moveToColumn:case this.moveToEol:break;default:d.lastHSPos=a.charCoords(b,"div").left}var e=c.repeat;b=a.findPosV(b,c.forward?e:-e,"line",d.lastHSPos);b.hitSide&&(c.forward?c={top:a.charCoords(b,"div").top+8,left:d.lastHSPos}:(c=a.charCoords(m(a.firstLine(),0),"div"),c.left=d.lastHSPos),b=a.coordsChar(c,"div"));d.lastHPos=b.ch;return b},moveByPage:function(a,b,c){var d=c.repeat;return a.findPosV(b,
c.forward?d:-d,"page")},moveByParagraph:function(a,b,c){return Qa(a,b,c.repeat,c.forward?1:-1)},moveByScroll:function(a,b,c,d){var e=a.getScrollInfo(),f=c.repeat;f||(f=e.clientHeight/(2*a.defaultTextHeight()));var h=a.charCoords(b,"local");c.repeat=f;b=S.moveByDisplayLines(a,b,c,d);if(!b)return null;c=a.charCoords(b,"local");a.scrollTo(null,e.top+c.top-h.top);return b},moveByWords:function(a,b,c){var d=b,e=c.repeat;b=!!c.forward;var f=!!c.wordEnd,h=!!c.bigWord;c=A(d);var l=[];(b&&!f||!b&&f)&&e++;
for(var k=!(b&&f),g=0;g<e;g++){b:{var n=a;var r=b,u=h,t=k,p=d.line,q=d.ch,P=n.getLine(p),y=r?1:-1;u=u?ta:ia;if(t&&""==P){p+=y;P=n.getLine(p);if(!Da(n,p)){n=null;break b}q=r?0:P.length}for(;;){if(t&&""==P){n={from:0,to:0,line:p};break b}r=0<y?P.length:-1;for(var w,aa;q!=r;){for(var la=!1,z=0;z<u.length&&!la;++z)if(u[z](P.charAt(q))){for(w=q;q!=r&&u[z](P.charAt(q));)q+=y;aa=q;la=w!=aa;if(w!=d.ch||p!=d.line||aa!=w+y){n={from:Math.min(w,aa+1),to:Math.max(w,aa),line:p};break b}}la||(q+=y)}p+=y;if(!Da(n,
p)){n=null;break b}P=n.getLine(p);q=0<y?0:P.length}}if(!n){h=B(a,a.lastLine());l.push(b?{line:a.lastLine(),from:h,to:h}:{line:0,from:0,to:0});break}l.push(n);d=m(n.line,b?n.to-1:n.from)}a=l.length!=e;e=l[0];h=l.pop();b&&!f?(a||e.from==c.ch&&e.line==c.line||(h=l.pop()),b=m(h.line,h.from)):b&&f?b=m(h.line,h.to-1):!b&&f?(a||e.to==c.ch&&e.line==c.line||(h=l.pop()),b=m(h.line,h.to)):b=m(h.line,h.from);return b},moveTillCharacter:function(a,b,c){a=ua(a,c.repeat,c.forward,c.selectedCharacter);b=c.forward?
-1:1;Pa(b,c);if(!a)return null;a.ch+=b;return a},moveToCharacter:function(a,b,c){var d=c.repeat;Pa(0,c);return ua(a,d,c.forward,c.selectedCharacter)||b},moveToSymbol:function(a,b,c){var d=c.repeat,e=c.forward,f=c.selectedCharacter;c=A(a.getCursor());var h=e?1:-1,l=e?a.lineCount():-1,k=c.ch,g=c.line,n=a.getLine(g);e={lineText:n,nextCh:n.charAt(k),lastCh:null,index:k,symb:f,reverseSymb:(e?{")":"(","}":"{"}:{"(":")","{":"}"})[f],forward:e,depth:0,curMoveThrough:!1};if(k=xb[f]){f=hb[k].init;k=hb[k].isComplete;
for(f&&f(e);g!==l&&d;)e.index+=h,e.nextCh=e.lineText.charAt(e.index),e.nextCh||(g+=h,e.lineText=a.getLine(g)||"",0<h?e.index=0:(f=e.lineText.length,e.index=0<f?f-1:0),e.nextCh=e.lineText.charAt(e.index)),k(e)&&(c.line=g,c.ch=e.index,d--);a=e.nextCh||e.curMoveThrough?m(g,e.index):c}else a=c;return a||b},moveToColumn:function(a,b,c,d){c=c.repeat;d.lastHPos=c-1;d.lastHSPos=a.charCoords(b,"div").left;b=a.getCursor().line;return E(a,m(b,c-1))},moveToEol:function(a,b,c,d){d.lastHPos=Infinity;b=m(b.line+
c.repeat-1,Infinity);c=a.clipPos(b);c.ch--;d.lastHSPos=a.charCoords(c,"div").left;return b},moveToFirstNonWhiteSpaceCharacter:function(a,b){return m(b.line,K(a.getLine(b.line)))},moveToMatchedSymbol:function(a,b){for(var c=b.line,d=b.ch,e=a.getLine(c),f;d<e.length&&(!(f=e.charAt(d))||-1=="()[]{}".indexOf(f)||(f=a.getTokenTypeAt(m(c,d+1)),"string"===f||"comment"===f));d++);return d<e.length?a.findMatchingBracket(m(c,d)).to:b},moveToStartOfLine:function(a,b){return m(b.line,0)},moveToLineOrEdgeOfDocument:function(a,
b,c){b=c.forward?a.lastLine():a.firstLine();c.repeatIsExplicit&&(b=c.repeat-a.getOption("firstLineNumber"));return m(b,K(a.getLine(b)))},textObjectManipulation:function(a,b,c,d){var e={"'":!0,'"':!0},f=c.selectedCharacter;"b"==f?f="(":"B"==f&&(f="{");var h=!c.textObjectInner;if({"(":")",")":"(","{":"}","}":"{","[":"]","]":"["}[f]){var g={"(":/[()]/,")":/[()]/,"[":/[[\]]/,"]":/[[\]]/,"{":/[{}]/,"}":/[{}]/}[f];var k={"(":"(",")":"(","[":"[","]":"[","{":"{","}":"{"}[f];c=a.getLine(b.line).charAt(b.ch)===
k?1:0;k=a.scanForBracket(m(b.line,b.ch+c),-1,null,{bracketRegex:g});g=a.scanForBracket(m(b.line,b.ch+c),1,null,{bracketRegex:g});if(k&&g){k=k.pos;g=g.pos;if(k.line==g.line&&k.ch>g.ch||k.line>g.line)b=k,k=g,g=b;h?g.ch+=1:k.ch+=1;b={start:k,end:g}}else b={start:b,end:b}}else if(e[f]){c=f;b=A(b);d=a.getLine(b.line).split("");f=d.indexOf(c);b.ch<f?b.ch=f:f<b.ch&&d[b.ch]==c&&(g=b.ch,--b.ch);if(d[b.ch]!=c||g)for(f=b.ch;-1<f&&!k;f--)d[f]==c&&(k=f+1);else k=b.ch+1;if(k&&!g)for(f=k,e=d.length;f<e&&!g;f++)d[f]==
c&&(g=f);k&&g?(h&&(--k,++g),b={start:m(b.line,k),end:m(b.line,g)}):b={start:b,end:b}}else if("W"===f)b=ha(a,h,!0,!0);else if("w"===f)b=ha(a,h,!0,!1);else if("p"===f)if(b=Qa(a,b,c.repeat,0,h),c.linewise=!0,d.visualMode)d.visualLine||(d.visualLine=!0);else{if(h=d.inputState.operatorArgs)h.linewise=!0;b.end.line--}else return null;return a.state.vim.visualMode?(h=b.start,b=b.end,g=a.state.vim.sel,k=g.head,g=g.anchor,z(b,h)&&(c=b,b=h,h=c),z(k,g)?(k=G(h,k),g=T(g,b)):(g=G(h,g),k=T(k,b),k=D(k,0,-1),-1==
k.ch&&k.line!=a.firstLine()&&(k=m(k.line-1,B(a,k.line-1)))),[g,k]):[b.start,b.end]},repeatLastCharacterSearch:function(a,b,c){var d=n.lastCharacterSearch,e=c.repeat,f=c.forward===d.forward,h=(d.increment?1:0)*(f?-1:1);a.moveH(-h,"char");c.inclusive=f?!0:!1;c=ua(a,e,f,d.selectedCharacter);if(!c)return a.moveH(h,"char"),b;c.ch+=h;return c}},gb={change:function(a,b,c){var d=a.state.vim;n.macroModeState.lastInsertModeChanges.inVisualBlock=d.visualBlock;if(d.visualMode){var e=a.getSelection();var f=Ia("",
c.length);a.replaceSelections(f);f=G(c[0].head,c[0].anchor)}else{f=c[0].anchor;var h=c[0].head;e=a.getRange(f,h);d=d.lastEditInputState||{};if("moveByWords"==d.motion&&!/^\s*$/.test(e)){var l=/\s+$/.exec(e);l&&d.motionArgs&&d.motionArgs.forward&&(h=D(h,0,-l[0].length),e=e.slice(0,-l[0].length))}d=new m(f.line-1,Number.MAX_VALUE);l=a.firstLine()==a.lastLine();h.line>a.lastLine()&&b.linewise&&!l?a.replaceRange("",d,h):a.replaceRange("",f,h);b.linewise&&(l||(a.setCursor(d),g.commands.newlineAndIndent(a)),
f.ch=Number.MAX_VALUE)}n.registerController.pushText(b.registerName,"change",e,b.linewise,1<c.length);ca.enterInsertMode(a,{head:f},a.state.vim)},"delete":function(a,b,c){var d=a.state.vim;if(d.visualBlock){var e=a.getSelection();var f=Ia("",c.length);a.replaceSelections(f);c=c[0].anchor}else f=c[0].anchor,c=c[0].head,b.linewise&&c.line!=a.firstLine()&&f.line==a.lastLine()&&f.line==c.line-1&&(f.line==a.firstLine()?f.ch=0:f=m(f.line-1,B(a,f.line-1))),e=a.getRange(f,c),a.replaceRange("",f,c),c=f,b.linewise&&
(c=S.moveToFirstNonWhiteSpaceCharacter(a,f));n.registerController.pushText(b.registerName,"delete",e,b.linewise,d.visualBlock);return E(a,c,d.insertMode)},indent:function(a,b,c){var d=a.state.vim,e=c[0].anchor.line,f=d.visualBlock?c[c.length-1].anchor.line:c[0].head.line;d=d.visualMode?b.repeat:1;for(b.linewise&&f--;e<=f;e++)for(var h=0;h<d;h++)a.indentLine(e,b.indentRight);return S.moveToFirstNonWhiteSpaceCharacter(a,c[0].anchor)},changeCase:function(a,b,c,d,e){for(var f=a.getSelections(),h=[],g=
b.toLower,k=0;k<f.length;k++){var m=f[k],n="";if(!0===g)n=m.toLowerCase();else if(!1===g)n=m.toUpperCase();else for(var r=0;r<m.length;r++){var u=m.charAt(r);n+=U(u)?u.toLowerCase():u.toUpperCase()}h.push(n)}a.replaceSelections(h);return b.shouldMoveCursor?e:!a.state.vim.visualMode&&b.linewise&&c[0].anchor.line+1==c[0].head.line?S.moveToFirstNonWhiteSpaceCharacter(a,d):b.linewise?d:G(c[0].anchor,c[0].head)},yank:function(a,b,c,d){var e=a.state.vim;a=a.getSelection();c=e.visualMode?G(e.sel.anchor,
e.sel.head,c[0].head,c[0].anchor):d;n.registerController.pushText(b.registerName,"yank",a,b.linewise,e.visualBlock);return c}},ca={jumpListWalk:function(a,b,c){c.visualMode||(c=b.repeat,b=(b=(b=n.jumpList.move(a,b.forward?c:-c))?b.find():void 0)?b:a.getCursor(),a.setCursor(b))},scroll:function(a,b,c){if(!c.visualMode){var d=b.repeat||1;c=a.defaultTextHeight();var e=a.getScrollInfo().top;d*=c;e=b.forward?e+d:e-d;d=A(a.getCursor());var f=a.charCoords(d,"local");b.forward?e>f.top?(d.line+=(e-f.top)/
c,d.line=Math.ceil(d.line),a.setCursor(d),f=a.charCoords(d,"local"),a.scrollTo(null,f.top)):a.scrollTo(null,e):(b=e+a.getScrollInfo().clientHeight,b<f.bottom?(d.line-=(f.bottom-b)/c,d.line=Math.floor(d.line),a.setCursor(d),f=a.charCoords(d,"local"),a.scrollTo(null,f.bottom-a.getScrollInfo().clientHeight)):a.scrollTo(null,e))}},scrollToCursor:function(a,b){var c=a.getCursor().line,d=a.charCoords(m(c,0),"local");c=a.getScrollInfo().clientHeight;var e=d.top;d=d.bottom-e;switch(b.position){case "center":e=
e-c/2+d;break;case "bottom":e=e-c+d}a.scrollTo(null,e)},replayMacro:function(a,b,c){var d=b.selectedCharacter;b=b.repeat;var e=n.macroModeState;"@"==d&&(d=e.latestRegister);for(;b--;){var f=a,h=c,l=e,k=d,m=n.registerController.getRegister(k);if(":"==k)m.keyBuffer[0]&&L.processCommand(f,m.keyBuffer[0]);else{k=m.keyBuffer;var v=0;l.isPlaying=!0;l.replaySearchQueries=m.searchQueries.slice(0);for(var r=0;r<k.length;r++)for(var u=k[r],t,p;u;)t=/<\w+-.+?>|<\w+>|./.exec(u),p=t[0],u=u.substring(t.index+p.length),
g.Vim.handleKey(f,p,"macro"),h.insertMode&&(t=m.insertModeChanges[v++].changes,n.macroModeState.lastInsertModeChanges.changes=t,ab(f,t,1),Y(f))}l.isPlaying=!1}},enterMacroRecordMode:function(a,b){var c=n.macroModeState;b=b.selectedCharacter;n.registerController.isValidRegister(b)&&c.enterMacroRecordMode(a,b)},toggleOverwrite:function(a){a.state.overwrite?(a.toggleOverwrite(!1),a.setOption("keyMap","vim-insert"),g.signal(a,"vim-mode-change",{mode:"insert"})):(a.toggleOverwrite(!0),a.setOption("keyMap",
"vim-replace"),g.signal(a,"vim-mode-change",{mode:"replace"}))},enterInsertMode:function(a,b,c){if(!a.getOption("readOnly")){c.insertMode=!0;c.insertModeRepeat=b&&b.repeat||1;var d=b?b.insertAt:null,e=c.sel,f=b.head||a.getCursor("head"),h=a.listSelections().length;if("eol"==d)f=m(f.line,B(a,f.line));else if("charAfter"==d)f=D(f,0,1);else if("firstNonBlank"==d)f=S.moveToFirstNonWhiteSpaceCharacter(a,f);else if("startOfSelectedArea"==d)c.visualBlock?(f=m(Math.min(e.head.line,e.anchor.line),Math.min(e.head.ch,
e.anchor.ch)),h=Math.abs(e.head.line-e.anchor.line)+1):f=e.head.line<e.anchor.line?e.head:m(e.anchor.line,0);else if("endOfSelectedArea"==d)c.visualBlock?(f=m(Math.min(e.head.line,e.anchor.line),Math.max(e.head.ch+1,e.anchor.ch)),h=Math.abs(e.head.line-e.anchor.line)+1):f=e.head.line>=e.anchor.line?D(e.head,0,1):m(e.anchor.line,0);else if("inplace"==d&&c.visualMode)return;a.setOption("disableInput",!1);b&&b.replace?(a.toggleOverwrite(!0),a.setOption("keyMap","vim-replace"),g.signal(a,"vim-mode-change",
{mode:"replace"})):(a.toggleOverwrite(!1),a.setOption("keyMap","vim-insert"),g.signal(a,"vim-mode-change",{mode:"insert"}));n.macroModeState.isPlaying||(a.on("change",Xa),g.on(a.getInputField(),"keydown",Ya));c.visualMode&&J(a);Ma(a,f,h)}},toggleVisualMode:function(a,b,c){var d=b.repeat,e=a.getCursor();c.visualMode?c.visualLine^b.linewise||c.visualBlock^b.blockwise?(c.visualLine=!!b.linewise,c.visualBlock=!!b.blockwise,g.signal(a,"vim-mode-change",{mode:"visual",subMode:c.visualLine?"linewise":c.visualBlock?
"blockwise":""}),W(a)):J(a):(c.visualMode=!0,c.visualLine=!!b.linewise,c.visualBlock=!!b.blockwise,b=E(a,m(e.line,e.ch+d-1),!0),c.sel={anchor:e,head:b},g.signal(a,"vim-mode-change",{mode:"visual",subMode:c.visualLine?"linewise":c.visualBlock?"blockwise":""}),W(a),N(a,c,"<",G(e,b)),N(a,c,">",T(e,b)))},reselectLastSelection:function(a,b,c){b=c.lastSelection;c.visualMode&&Na(a,c);if(b){var d=b.anchorMark.find(),e=b.headMark.find();d&&e&&(c.sel={anchor:d,head:e},c.visualMode=!0,c.visualLine=b.visualLine,
c.visualBlock=b.visualBlock,W(a),N(a,c,"<",G(d,e)),N(a,c,">",T(d,e)),g.signal(a,"vim-mode-change",{mode:"visual",subMode:c.visualLine?"linewise":c.visualBlock?"blockwise":""}))}},joinLines:function(a,b,c){if(c.visualMode){b=a.getCursor("anchor");var d=a.getCursor("head");if(z(d,b)){var e=d;d=b;b=e}d.ch=B(a,d.line)-1}else e=Math.max(b.repeat,2),b=a.getCursor(),d=E(a,m(b.line+e-1,Infinity));for(var f=0,h=b.line;h<d.line;h++){f=B(a,b.line);e=m(b.line+1,B(a,b.line+1));var g=a.getRange(b,e);g=g.replace(/\n\s*/g,
" ");a.replaceRange(g,b,e)}b=m(b.line,f);c.visualMode&&J(a,!1);a.setCursor(b)},newLineAndEnterInsertMode:function(a,b,c){c.insertMode=!0;var d=A(a.getCursor());d.line!==a.firstLine()||b.after?(d.line=b.after?d.line:d.line-1,d.ch=B(a,d.line),a.setCursor(d),(g.commands.newlineAndIndentContinueComment||g.commands.newlineAndIndent)(a)):(a.replaceRange("\n",m(a.firstLine(),0)),a.setCursor(a.firstLine(),0));this.enterInsertMode(a,{repeat:b.repeat},c)},paste:function(a,b,c){var d,e=A(a.getCursor()),f=n.registerController.getRegister(b.registerName);
if(d=f.toString()){if(b.matchIndent){var h=a.getOption("tabSize"),g=function(a){var b=a.split("\t").length-1;a=a.split(" ").length-1;return b*h+1*a},k=a.getLine(a.getCursor().line),x=g(k.match(/^\s*/)[0]);k=d.replace(/\n$/,"");var v=d!==k,r=g(d.match(/^\s*/)[0]);d=k.replace(/^\s*/gm,function(b){b=x+(g(b)-r);return 0>b?"":a.getOption("indentWithTabs")?Array(Math.floor(b/h)+1).join("\t"):Array(b+1).join(" ")});d+=v?"\n":""}1<b.repeat&&(d=Array(b.repeat+1).join(d));k=f.linewise;f=f.blockwise;if(k)c.visualMode?
d=c.visualLine?d.slice(0,-1):"\n"+d.slice(0,d.length-1)+"\n":b.after?(d="\n"+d.slice(0,d.length-1),e.ch=B(a,e.line)):e.ch=0;else{if(f)for(d=d.split("\n"),v=0;v<d.length;v++)d[v]=""==d[v]?" ":d[v];e.ch+=b.after?1:0}var u;if(c.visualMode){c.lastPastedText=d;b=pb(a,c);e=b[0];b=b[1];v=a.getSelection();var t=a.listSelections();t=Array(t.length).join("1").split("1");c.lastSelection&&(u=c.lastSelection.headMark.find());n.registerController.unnamedRegister.setText(v);f?(a.replaceSelections(t),b=m(e.line+
d.length-1,e.ch),a.setCursor(e),La(a,b),a.replaceSelections(d),d=e):c.visualBlock?(a.replaceSelections(t),a.setCursor(e),a.replaceRange(d,e,e),d=e):(a.replaceRange(d,e,b),d=a.posFromIndex(a.indexFromPos(e)+d.length-1));u&&(c.lastSelection.headMark=a.setBookmark(u));k&&(d.ch=0)}else if(f){a.setCursor(e);for(v=0;v<d.length;v++)u=e.line+v,u>a.lastLine()&&a.replaceRange("\n",m(u,0)),B(a,u)<e.ch&&ob(a,u,e.ch);a.setCursor(e);La(a,m(e.line+d.length-1,e.ch));a.replaceSelections(d);d=e}else a.replaceRange(d,
e),k&&b.after?d=m(e.line+1,K(a.getLine(e.line+1))):k&&!b.after?d=m(e.line,K(a.getLine(e.line))):!k&&b.after?(u=a.indexFromPos(e),d=a.posFromIndex(u+d.length-1)):(u=a.indexFromPos(e),d=a.posFromIndex(u+d.length));c.visualMode&&J(a,!1);a.setCursor(d)}},undo:function(a,b){a.operation(function(){Ja(a,g.commands.undo,b.repeat)();a.setCursor(a.getCursor("anchor"))})},redo:function(a,b){Ja(a,g.commands.redo,b.repeat)()},setRegister:function(a,b,c){c.inputState.registerName=b.selectedCharacter},setMark:function(a,
b,c){N(a,c,b.selectedCharacter,a.getCursor())},replace:function(a,b,c){var d=b.selectedCharacter,e=a.getCursor(),f=a.listSelections();if(c.visualMode){e=a.getCursor("start");var h=a.getCursor("end")}else h=a.getLine(e.line),b=e.ch+b.repeat,b>h.length&&(b=h.length),h=m(e.line,b);"\n"==d?(c.visualMode||a.replaceRange("",e,h),(g.commands.newlineAndIndentContinueComment||g.commands.newlineAndIndent)(a)):(b=a.getRange(e,h),b=b.replace(/[^\n]/g,d),c.visualBlock?(e=Array(a.getOption("tabSize")+1).join(" "),
b=a.getSelection(),b=b.replace(/\t/g,e).replace(/[^\n]/g,d).split("\n"),a.replaceSelections(b)):a.replaceRange(b,e,h),c.visualMode?(e=z(f[0].anchor,f[0].head)?f[0].anchor:f[0].head,a.setCursor(e),J(a,!1)):a.setCursor(D(h,0,-1)))},incrementNumberToken:function(a,b){for(var c=a.getCursor(),d=a.getLine(c.line),e=/(-?)(?:(0x)([\da-f]+)|(0b|0|)(\d+))/gi,f,g,l;null!==(f=e.exec(d))&&!(g=f.index,l=g+f[0].length,c.ch<l););if((b.backtrack||!(l<=c.ch))&&f){d=f[2]||f[4];e=f[3]||f[5];var k=b.increase?1:-1,n={"0b":2,
0:8,"":10,"0x":16}[d.toLowerCase()];b=(parseInt(f[1]+e,n)+k*b.repeat).toString(n);f=d?Array(e.length-b.length+1+f[1].length).join("0"):"";b="-"===b.charAt(0)?"-"+d+f+b.substr(1):d+f+b;f=m(c.line,g);l=m(c.line,l);a.replaceRange(b,f,l);a.setCursor(m(c.line,g+b.length-1))}},repeatLastEdit:function(a,b,c){if(c.lastEditInputState){var d=b.repeat;d&&b.repeatIsExplicit?c.lastEditInputState.repeatOverride=d:d=c.lastEditInputState.repeatOverride||d;Za(a,c,d,!1)}},indent:function(a,b){a.indentLine(a.getCursor().line,
b.indentRight)},exitInsertMode:Y},xb={"(":"bracket",")":"bracket","{":"bracket","}":"bracket","[":"section","]":"section","*":"comment","/":"comment",m:"method",M:"method","#":"preprocess"},hb={bracket:{isComplete:function(a){if(a.nextCh===a.symb){if(a.depth++,1<=a.depth)return!0}else a.nextCh===a.reverseSymb&&a.depth--;return!1}},section:{init:function(a){a.curMoveThrough=!0;a.symb=(a.forward?"]":"[")===a.symb?"{":"}"},isComplete:function(a){return 0===a.index&&a.nextCh===a.symb}},comment:{isComplete:function(a){var b=
"*"===a.lastCh&&"/"===a.nextCh;a.lastCh=a.nextCh;return b}},method:{init:function(a){a.symb="m"===a.symb?"{":"}";a.reverseSymb="{"===a.symb?"}":"{"},isComplete:function(a){return a.nextCh===a.symb?!0:!1}},preprocess:{init:function(a){a.index=0},isComplete:function(a){if("#"===a.nextCh){var b=a.lineText.match(/#(\w+)/)[1];if("endif"===b){if(a.forward&&0===a.depth)return!0;a.depth++}else if("if"===b){if(!a.forward&&0===a.depth)return!0;a.depth--}if("else"===b&&0===a.depth)return!0}return!1}}};da("pcre",
!0,"boolean");Ra.prototype={getQuery:function(){return n.query},setQuery:function(a){n.query=a},getOverlay:function(){return this.searchOverlay},setOverlay:function(a){this.searchOverlay=a},isReversed:function(){return n.isReversed},setReversed:function(a){n.isReversed=a},getScrollbarAnnotate:function(){return this.annotate},setScrollbarAnnotate:function(a){this.annotate=a}};var ib={"\\n":"\n","\\r":"\r","\\t":"\t"},jb={"\\/":"/","\\\\":"\\","\\n":"\n","\\r":"\r","\\t":"\t"},wb="(Javascript regexp)",
kb=function(){this.buildCommandMap_()};kb.prototype={processCommand:function(a,b,c){var d=this;a.operation(function(){a.curOp.isVimOp=!0;d._processCommand(a,b,c)})},_processCommand:function(a,b,c){var d=a.state.vim,e=n.registerController.getRegister(":"),f=e.toString();d.visualMode&&J(a);d=new g.StringStream(b);e.setText(b);c=c||{};c.input=b;try{this.parseInput_(a,d,c)}catch(k){throw y(a,k),k;}var h;if(c.commandName){if(h=this.matchCommand_(c.commandName)){var l=h.name;h.excludeFromCommandHistory&&
e.setText(f);this.parseCommandArgs_(d,c,h);if("exToKey"==h.type){for(b=0;b<h.toKeys.length;b++)g.Vim.handleKey(a,h.toKeys[b],"mapping");return}if("exToEx"==h.type){this.processCommand(a,h.toInput);return}}}else void 0!==c.line&&(l="move");if(l)try{fb[l](a,c),h&&h.possiblyAsync||!c.callback||c.callback()}catch(k){throw y(a,k),k;}else y(a,'Not an editor command ":'+b+'"')},parseInput_:function(a,b,c){b.eatWhile(":");b.eat("%")?(c.line=a.firstLine(),c.lineEnd=a.lastLine()):(c.line=this.parseLineSpec_(a,
b),void 0!==c.line&&b.eat(",")&&(c.lineEnd=this.parseLineSpec_(a,b)));a=b.match(/^(\w+)/);c.commandName=a?a[1]:b.match(/.*/)[0];return c},parseLineSpec_:function(a,b){var c=b.match(/^(\d+)/);if(c)return parseInt(c[1],10)-1;switch(b.next()){case ".":return this.parseLineSpecOffset_(b,a.getCursor().line);case "$":return this.parseLineSpecOffset_(b,a.lastLine());case "'":c=b.next();a=Wa(a,a.state.vim,c);if(!a)throw Error("Mark not set");return this.parseLineSpecOffset_(b,a.line);case "-":case "+":return b.backUp(1),
this.parseLineSpecOffset_(b,a.getCursor().line);default:b.backUp(1)}},parseLineSpecOffset_:function(a,b){if(a=a.match(/^([+-])?(\d+)/)){var c=parseInt(a[2],10);b="-"==a[1]?b-c:b+c}return b},parseCommandArgs_:function(a,b,c){a.eol()||(b.argString=a.match(/.*/)[0],a=c.argDelimiter||/\s+/,a=ra(b.argString).split(a),a.length&&a[0]&&(b.args=a))},matchCommand_:function(a){for(var b=a.length;0<b;b--){var c=a.substring(0,b);if(this.commandMap_[c]&&(c=this.commandMap_[c],0===c.name.indexOf(a)))return c}return null},
buildCommandMap_:function(){this.commandMap_={};for(var a=0;a<w.length;a++){var b=w[a];this.commandMap_[b.shortName||b.name]=b}},map:function(a,b,c){if(":"!=a&&":"==a.charAt(0)){if(c)throw Error("Mode not supported for ex mappings");c=a.substring(1);":"!=b&&":"==b.charAt(0)?this.commandMap_[c]={name:c,type:"exToEx",toInput:b.substring(1),user:!0}:this.commandMap_[c]={name:c,type:"exToKey",toKeys:b,user:!0}}else b=":"!=b&&":"==b.charAt(0)?{keys:a,type:"keyToEx",exArgs:{input:b.substring(1)}}:{keys:a,
type:"keyToKey",toKeys:b},c&&(b.context=c),q.unshift(b)},unmap:function(a,b){if(":"!=a&&":"==a.charAt(0)){if(b)throw Error("Mode not supported for ex mappings");a=a.substring(1);if(this.commandMap_[a]&&this.commandMap_[a].user){delete this.commandMap_[a];return}}else for(var c=0;c<q.length;c++)if(a==q[c].keys&&q[c].context===b){q.splice(c,1);return}throw Error("No such mapping.");}};var fb={colorscheme:function(a,b){!b.args||1>b.args.length?y(a,a.getOption("theme")):a.setOption("theme",b.args[0])},
map:function(a,b,c){var d=b.args;!d||2>d.length?a&&y(a,"Invalid mapping: "+b.input):L.map(d[0],d[1],c)},imap:function(a,b){this.map(a,b,"insert")},nmap:function(a,b){this.map(a,b,"normal")},vmap:function(a,b){this.map(a,b,"visual")},unmap:function(a,b,c){var d=b.args;!d||1>d.length?a&&y(a,"No such mapping: "+b.input):L.unmap(d[0],c)},move:function(a,b){R.processCommand(a,a.state.vim,{type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0},repeatOverride:b.line+
1})},set:function(a,b){var c=b.args,d=b.setCfg||{};if(!c||1>c.length)a&&y(a,"Invalid mapping: "+b.input);else{var e=c[0].split("=");c=e[0];e=e[1];var f=!1;if("?"==c.charAt(c.length-1)){if(e)throw Error("Trailing characters: "+b.argString);c=c.substring(0,c.length-1);f=!0}void 0===e&&"no"==c.substring(0,2)&&(c=c.substring(2),e=!1);(b=M[c]&&"boolean"==M[c].type)&&void 0==e&&(e=!0);!b&&void 0===e||f?(d=V(c,a,d),d instanceof Error?y(a,d.message):!0===d||!1===d?y(a," "+(d?"":"no")+c):y(a,"  "+c+"="+d)):
(d=pa(c,e,a,d),d instanceof Error&&y(a,d.message))}},setlocal:function(a,b){b.setCfg={scope:"local"};this.set(a,b)},setglobal:function(a,b){b.setCfg={scope:"global"};this.set(a,b)},registers:function(a,b){var c=b.args;b=n.registerController.registers;var d="----------Registers----------<br><br>";if(c){c=c.join("");for(var e=0;e<c.length;e++){var f=c.charAt(e);if(n.registerController.isValidRegister(f)){var g=b[f]||new H;d+='"'+f+"    "+g.toString()+"<br>"}}}else for(f in b)c=b[f].toString(),c.length&&
(d+='"'+f+"    "+c+"<br>");y(a,d)},sort:function(a,b){function c(a,b){if(e){var c=a;a=b;b=c}f&&(a=a.toLowerCase(),b=b.toLowerCase());c=l&&u.exec(a);var d=l&&u.exec(b);if(!c)return a<b?-1:1;c=parseInt((c[1]+c[2]).toLowerCase(),t);d=parseInt((d[1]+d[2]).toLowerCase(),t);return c-d}function d(a,b){if(e){var c=a;a=b;b=c}f&&(a[0]=a[0].toLowerCase(),b[0]=b[0].toLowerCase());return a[0]<b[0]?-1:1}var e,f,h,l,k,n=function(){if(b.argString){var a=new g.StringStream(b.argString);a.eat("!")&&(e=!0);if(!a.eol()){if(!a.eatSpace())return"Invalid arguments";
var c=a.match(/([dinuox]+)?\s*(\/.+\/)?\s*/);if(!c&&!a.eol())return"Invalid arguments";if(c[1]){f=-1!=c[1].indexOf("i");h=-1!=c[1].indexOf("u");a=-1!=c[1].indexOf("d")||-1!=c[1].indexOf("n")&&1;var d=-1!=c[1].indexOf("x")&&1,m=-1!=c[1].indexOf("o")&&1;if(1<a+d+m)return"Invalid arguments";l=a&&"decimal"||d&&"hex"||m&&"octal"}c[2]&&(k=new RegExp(c[2].substr(1,c[2].length-2),f?"i":""))}}}();if(n)y(a,n+": "+b.argString);else{n=b.line||a.firstLine();var v=b.lineEnd||b.line||a.lastLine();if(n!=v){n=m(n,
0);v=m(v,B(a,v));var r=a.getRange(n,v).split("\n"),u=k?k:"decimal"==l?/(-?)([\d]+)/:"hex"==l?/(-?)(?:0x)?([0-9a-f]+)/i:"octal"==l?/([0-7]+)/:null,t="decimal"==l?10:"hex"==l?16:"octal"==l?8:null,p=[],q=[];if(l||k)for(var w=0;w<r.length;w++){var z=k?r[w].match(k):null;z&&""!=z[0]?p.push(z):!k&&u.exec(r[w])?p.push(r[w]):q.push(r[w])}else q=r;p.sort(k?d:c);if(k)for(w=0;w<p.length;w++)p[w]=p[w].input;else l||q.sort(c);r=e?p.concat(q):q.concat(p);if(h)for(p=r,r=[],w=0;w<p.length;w++){p[w]!=A&&r.push(p[w]);
var A=p[w]}a.replaceRange(r.join("\n"),n,v)}}},global:function(a,b){var c=b.argString;if(c){var d=void 0!==b.line?b.line:a.firstLine();b=b.lineEnd||b.line||a.lastLine();var e=Sa(c);if(e.length){c=e[0];var f=e.slice(1,e.length).join("/")}if(c)try{X(a,c,!0,!0)}catch(x){y(a,"Invalid regex: "+c);return}c=O(a).getQuery();var g=[];for(e="";d<=b;d++)c.test(a.getLine(d))&&(g.push(d+1),e+=a.getLine(d)+"<br>");if(f){var l=0,k=function(){l<g.length&&L.processCommand(a,g[l]+f,{callback:k});l++};k()}else y(a,
e)}else y(a,"Regular Expression missing from global")},substitute:function(a,b){if(!a.getSearchCursor)throw Error("Search feature not available. Requires searchcursor.js or any other getSearchCursor implementation.");var c=b.argString,d=c?Sa(c):[],e="",f,h=!1,l=!1;if(d.length){var k=d[0];e=d[1];k&&"$"===k[k.length-1]&&(k=k.slice(0,k.length-1)+"\\n",e=e?e+"\n":"\n");if(void 0!==e){if(V("pcre"))for(e=new g.StringStream(e),f=[];!e.eol();){for(;e.peek()&&"\\"!=e.peek();)f.push(e.next());c=!1;for(var q in jb)if(e.match(q,
!0)){c=!0;f.push(jb[q]);break}c||f.push(e.next())}else for(q=!1,f=[],c=-1;c<e.length;c++){var v=e.charAt(c)||"",r=e.charAt(c+1)||"";ib[v+r]?(f.push(ib[v+r]),c++):q?(f.push(v),q=!1):"\\"===v?(q=!0,ub.test(r)||"$"===r?f.push("$"):"/"!==r&&"\\"!==r&&f.push("\\")):("$"===v&&f.push("$"),f.push(v),"/"===r&&f.push("\\"))}e=f.join("");n.lastSubstituteReplacePart=e}f=d[2]?d[2].split(" "):[]}else if(c&&c.length){y(a,"Substitutions should be of the form :s/pattern/replace/");return}if(f){d=f[0];var u=parseInt(f[1]);
d&&(-1!=d.indexOf("c")&&(h=!0,d.replace("c","")),-1!=d.indexOf("g")&&(l=!0,d.replace("g","")),k=k+"/"+d)}if(k)try{X(a,k,!0,!0)}catch(t){y(a,"Invalid regex: "+k);return}e=e||n.lastSubstituteReplacePart;void 0===e?y(a,"No previous substitute regular expression"):(k=O(a).getQuery(),d=void 0!==b.line?b.line:a.getCursor().line,q=b.lineEnd||d,d==a.firstLine()&&q==a.lastLine()&&(q=Infinity),u&&(d=q,q=d+u-1),u=E(a,m(d,0)),u=a.getSearchCursor(k,u),tb(a,h,l,d,q,u,k,e,b.callback))},redo:g.commands.redo,undo:g.commands.undo,
write:function(a){g.commands.save?g.commands.save(a):a.save&&a.save()},nohlsearch:function(a){va(a)},yank:function(a){var b=A(a.getCursor()).line;a=a.getLine(b);n.registerController.pushText("0","yank",a,!0,!0)},delmarks:function(a,b){if(b.argString&&ra(b.argString))for(var c=a.state.vim,d=new g.StringStream(ra(b.argString));!d.eol();){d.eatSpace();var e=d.pos;if(!d.match(/[a-zA-Z]/,!1)){y(a,"Invalid argument: "+b.argString.substring(e));break}var f=d.next();if(d.match("-",!0)){if(!d.match(/[a-zA-Z]/,
!1)){y(a,"Invalid argument: "+b.argString.substring(e));break}var h=d.next();if(/^[a-z]$/.test(f)&&/^[a-z]$/.test(h)||U(f)&&U(h)){f=f.charCodeAt(0);h=h.charCodeAt(0);if(f>=h){y(a,"Invalid argument: "+b.argString.substring(e));break}for(e=0;e<=h-f;e++){var l=String.fromCharCode(f+e);delete c.marks[l]}}else{y(a,"Invalid argument: "+f+"-");break}}else delete c.marks[f]}else y(a,"Argument required")}},L=new kb;g.keyMap.vim={attach:Q,detach:C,call:ma};da("insertModeEscKeysTimeout",200,"number");g.keyMap["vim-insert"]=
{fallthrough:["default"],attach:Q,detach:C,call:ma};g.keyMap["vim-replace"]={Backspace:"goCharLeft",fallthrough:["vim-insert"],attach:Q,detach:C,call:ma};Ga();return vb}()});
