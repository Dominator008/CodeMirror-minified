'use strict';(function(g){"object"==typeof exports&&"object"==typeof module?g(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],g):g(CodeMirror)})(function(g){function n(b){var a;if(b.getOption("disableInput"))return g.Pass;for(var f=b.listSelections(),d,m=[],k=0;k<f.length;k++){var h=f[k].head;if(!/\bcomment\b/.test(b.getTokenTypeAt(h)))return g.Pass;var c=b.getModeAt(h);if(!d)d=c;else if(d!=c)return g.Pass;c=null;if(d.blockCommentStart&&d.blockCommentContinue){var e=
b.getLine(h.line).slice(0,h.ch);var l=e.lastIndexOf(d.blockCommentEnd);if(-1==l||l!=h.ch-d.blockCommentEnd.length)if(-1<(a=e.lastIndexOf(d.blockCommentStart))&&a>l){if(c=e.slice(0,a),/\S/.test(c))for(c="",e=0;e<a;++e)c+=" "}else-1<(a=e.indexOf(d.blockCommentContinue))&&!/\S/.test(e.slice(0,a))&&(c=e.slice(0,a));null!=c&&(c+=d.blockCommentContinue)}null==c&&d.lineComment&&p(b)&&(e=b.getLine(h.line),a=e.indexOf(d.lineComment),-1<a&&(c=e.slice(0,a),c=/\S/.test(c)?null:c+(d.lineComment+e.slice(a+d.lineComment.length).match(/^\s*/)[0])));
if(null==c)return g.Pass;m[k]="\n"+c}b.operation(function(){for(var a=f.length-1;0<=a;a--)b.replaceRange(m[a],f[a].from(),f[a].to(),"+insert")})}function p(b){return(b=b.getOption("continueComments"))&&"object"==typeof b?!1!==b.continueLineComment:!0}g.defineOption("continueComments",null,function(b,a,f){f&&f!=g.Init&&b.removeKeyMap("continueComment");a&&(f="Enter","string"==typeof a?f=a:"object"==typeof a&&a.key&&(f=a.key),a={name:"continueComment"},a[f]=n,b.addKeyMap(a))})});
