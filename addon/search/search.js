'use strict';var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,g,e){b instanceof String&&(b=String(b));for(var l=b.length,k=0;k<l;k++){var r=b[k];if(g.call(e,r,k,b))return{i:k,v:r}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,g,e){if(b==Array.prototype||b==Object.prototype)return b;b[g]=e.value;return b};$jscomp.getGlobal=function(b){b=["object"==typeof globalThis&&globalThis,b,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var g=0;g<b.length;++g){var e=b[g];if(e&&e.Math==Math)return e}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(b,g){var e=$jscomp.propertyToPolyfillSymbol[g];if(null==e)return b[g];e=b[e];return void 0!==e?e:b[g]};
$jscomp.polyfill=function(b,g,e,l){g&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(b,g,e,l):$jscomp.polyfillUnisolated(b,g,e,l))};$jscomp.polyfillUnisolated=function(b,g,e,l){e=$jscomp.global;b=b.split(".");for(l=0;l<b.length-1;l++){var k=b[l];if(!(k in e))return;e=e[k]}b=b[b.length-1];l=e[b];g=g(l);g!=l&&null!=g&&$jscomp.defineProperty(e,b,{configurable:!0,writable:!0,value:g})};
$jscomp.polyfillIsolated=function(b,g,e,l){var k=b.split(".");b=1===k.length;l=k[0];l=!b&&l in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var r=0;r<k.length-1;r++){var y=k[r];if(!(y in l))return;l=l[y]}k=k[k.length-1];e=$jscomp.IS_SYMBOL_NATIVE&&"es6"===e?l[k]:null;g=g(e);null!=g&&(b?$jscomp.defineProperty($jscomp.polyfills,k,{configurable:!0,writable:!0,value:g}):g!==e&&(void 0===$jscomp.propertyToPolyfillSymbol[k]&&(e=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[k]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(k):$jscomp.POLYFILL_PREFIX+e+"$"+k),$jscomp.defineProperty(l,$jscomp.propertyToPolyfillSymbol[k],{configurable:!0,writable:!0,value:g})))};$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(g,e){return $jscomp.findInternal(this,g,e).v}},"es6","es3");
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror"),require("./searchcursor"),require("../dialog/dialog")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./searchcursor","../dialog/dialog"],b):b(CodeMirror)})(function(b){function g(a,c){"string"==typeof a?a=new RegExp(a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),c?"gi":"g"):a.global||(a=new RegExp(a.source,a.ignoreCase?"gi":"g"));return{token:function(f){a.lastIndex=f.pos;
var h=a.exec(f.string);if(h&&h.index==f.pos)return f.pos+=h[0].length||1,"searching";h?f.pos=h.index:f.skipToEnd()}}}function e(){this.overlay=this.posFrom=this.posTo=this.lastQuery=this.query=null}function l(a){return a.state.search||(a.state.search=new e)}function k(a){return"string"==typeof a&&a==a.toLowerCase()}function r(a,c,f){return a.getSearchCursor(c,f,{caseFold:k(c),multiline:!0})}function y(a,c,f,h,d){a.openDialog(c,h,{value:f,selectValueOnOpen:!0,closeOnEnter:!1,onClose:function(){x(a)},
onKeyDown:d,bottom:a.options.search.bottom})}function B(a,c,f,h,d){a.openDialog?a.openDialog(c,d,{value:h,selectValueOnOpen:!0,bottom:a.options.search.bottom}):d(prompt(f,h))}function I(a,c,f,h){if(a.openConfirm)a.openConfirm(c,h);else if(confirm(f))h[0]()}function D(a){return a.replace(/\\([nrt\\])/g,function(c,f){return"n"==f?"\n":"r"==f?"\r":"t"==f?"\t":"\\"==f?"\\":c})}function E(a){var c=a.match(/^\/(.*)\/([a-z]*)$/);if(c)try{a=new RegExp(c[1],-1==c[2].indexOf("i")?"":"i")}catch(f){}else a=D(a);
if("string"==typeof a?""==a:a.test(""))a=/x^/;return a}function z(a,c,f){c.queryText=f;c.query=E(f);a.removeOverlay(c.overlay,k(c.query));c.overlay=g(c.query,k(c.query));a.addOverlay(c.overlay);a.showMatchesOnScrollbar&&(c.annotate&&(c.annotate.clear(),c.annotate=null),c.annotate=a.showMatchesOnScrollbar(c.query,k(c.query)))}function v(a,c,f,h){var d=l(a);if(d.query)return A(a,c);var p=a.getSelection()||d.lastQuery;p instanceof RegExp&&"x^"==p.source&&(p=null);if(f&&a.openDialog){var m=null,w=function(q,
t){b.e_stop(t);q&&(q!=d.queryText&&(z(a,d,q),d.posFrom=d.posTo=a.getCursor()),m&&(m.style.opacity=1),A(a,t.shiftKey,function(n,u){var C;3>u.line&&document.querySelector&&(C=a.display.wrapper.querySelector(".CodeMirror-dialog"))&&C.getBoundingClientRect().bottom-4>a.cursorCoords(u,"window").top&&((m=C).style.opacity=.4)}))};y(a,F(a),p,w,function(q,t){var n=b.keyName(q),u=a.getOption("extraKeys");n=u&&u[n]||b.keyMap[a.getOption("keyMap")][n];if("findNext"==n||"findPrev"==n||"findPersistentNext"==n||
"findPersistentPrev"==n)b.e_stop(q),z(a,l(a),t),a.execCommand(n);else if("find"==n||"findPersistent"==n)b.e_stop(q),w(t,q)});h&&p&&(z(a,d,p),A(a,c))}else B(a,F(a),"Search for:",p,function(q){q&&!d.query&&a.operation(function(){z(a,d,q);d.posFrom=d.posTo=a.getCursor();A(a,c)})})}function A(a,c,f){a.operation(function(){var h=l(a),d=r(a,h.query,c?h.posFrom:h.posTo);if(!d.find(c)&&(d=r(a,h.query,c?b.Pos(a.lastLine()):b.Pos(a.firstLine(),0)),!d.find(c)))return;a.setSelection(d.from(),d.to());a.scrollIntoView({from:d.from(),
to:d.to()},20);h.posFrom=d.from();h.posTo=d.to();f&&f(d.from(),d.to())})}function x(a){a.operation(function(){var c=l(a);if(c.lastQuery=c.query)c.query=c.queryText=null,a.removeOverlay(c.overlay),c.annotate&&(c.annotate.clear(),c.annotate=null)})}function F(a){return'<span class="CodeMirror-search-label">'+a.phrase("Search:")+'</span> <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">'+a.phrase("(Use /re/ syntax for regexp search)")+
"</span>"}function J(a){return'<span class="CodeMirror-search-label">'+a.phrase("Replace?")+"</span> <button>"+a.phrase("Yes")+"</button> <button>"+a.phrase("No")+"</button> <button>"+a.phrase("All")+"</button> <button>"+a.phrase("Stop")+"</button> "}function G(a,c,f){a.operation(function(){for(var h=r(a,c);h.findNext();)if("string"!=typeof c){var d=a.getRange(h.from(),h.to()).match(c);h.replace(f.replace(/\$(\d)/g,function(p,m){return d[m]}))}else h.replace(f)})}function H(a,c){if(!a.getOption("readOnly")){var f=
a.getSelection()||l(a).lastQuery,h='<span class="CodeMirror-search-label">'+(c?a.phrase("Replace all:"):a.phrase("Replace:"))+"</span>";B(a,h+(' <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">'+a.phrase("(Use /re/ syntax for regexp search)")+"</span>"),h,f,function(d){d&&(d=E(d),B(a,'<span class="CodeMirror-search-label">'+a.phrase("With:")+'</span> <input type="text" style="width: 10em" class="CodeMirror-search-field"/>',
a.phrase("Replace with:"),"",function(p){p=D(p);if(c)G(a,d,p);else{x(a);var m=r(a,d,a.getCursor("from")),w=function(){var t=m.from(),n;if(!(n=m.findNext())&&(m=r(a,d),!(n=m.findNext())||t&&m.from().line==t.line&&m.from().ch==t.ch))return;a.setSelection(m.from(),m.to());a.scrollIntoView({from:m.from(),to:m.to()});I(a,J(a),a.phrase("Replace?"),[function(){q(n)},w,function(){G(a,d,p)}])},q=function(t){m.replace("string"==typeof d?p:p.replace(/\$(\d)/g,function(n,u){return t[u]}));w()};w()}}))})}}b.defineOption("search",
{bottom:!1});b.commands.find=function(a){x(a);v(a)};b.commands.findPersistent=function(a){x(a);v(a,!1,!0)};b.commands.findPersistentNext=function(a){v(a,!1,!0,!0)};b.commands.findPersistentPrev=function(a){v(a,!0,!0,!0)};b.commands.findNext=v;b.commands.findPrev=function(a){v(a,!0)};b.commands.clearSearch=x;b.commands.replace=H;b.commands.replaceAll=function(a){H(a,!0)}});
