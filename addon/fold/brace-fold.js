(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],b):b(CodeMirror)})(function(b){b.registerHelper("fold","brace",function(c,d){function k(n){var g=d.ch;for(var q=0;;){var p=0>=g?-1:m.lastIndexOf(n,g-1);if(-1==p){if(1==q)break;q=1;g=m.length}else{if(1==q&&p<d.ch)break;g=c.getTokenTypeAt(b.Pos(e,p+1));if(!/^(comment|string)/.test(g))return{ch:p+1,tokenType:g};g=p-1}}}function l(n,g,
q){var p=1,x=c.lastLine(),w=q.ch,r=e;a:for(;r<=x;++r)for(var t=c.getLine(r),h=r==e?w:0;;){var u=t.indexOf(n,h);h=t.indexOf(g,h);0>u&&(u=t.length);0>h&&(h=t.length);h=Math.min(u,h);if(h==t.length)break;if(c.getTokenTypeAt(b.Pos(r,h+1))==q.tokenType)if(h==u)++p;else if(!--p){var v=r;var y=h;break a}++h}return null==v||e==v?null:{from:b.Pos(e,w),to:b.Pos(v,y)}}var e=d.line,m=c.getLine(e),a=k("{"),f=k("[");return a&&(!f||f.ch>a.ch)?l("{","}",a)||f&&l("[","]",f):f?l("[","]",f)||a&&l("{","}",a):null});
b.registerHelper("fold","import",function(c,d){function k(a){if(a<c.firstLine()||a>c.lastLine())return null;var f=c.getTokenAt(b.Pos(a,1));/\S/.test(f.string)||(f=c.getTokenAt(b.Pos(a,f.end+1)));if("keyword"!=f.type||"import"!=f.string)return null;var n=a;for(a=Math.min(c.lastLine(),a+10);n<=a;++n){var g=c.getLine(n).indexOf(";");if(-1!=g)return{startCh:f.end,end:b.Pos(n,g)}}}d=d.line;var l=k(d),e;if(!l||k(d-1)||(e=k(d-2))&&e.end.line==d-1)return null;for(e=l.end;;){var m=k(e.line+1);if(null==m)break;
e=m.end}return{from:c.clipPos(b.Pos(d,l.startCh+1)),to:e}});b.registerHelper("fold","include",function(c,d){function k(m){if(m<c.firstLine()||m>c.lastLine())return null;var a=c.getTokenAt(b.Pos(m,1));/\S/.test(a.string)||(a=c.getTokenAt(b.Pos(m,a.end+1)));if("meta"==a.type&&"#include"==a.string.slice(0,8))return a.start+8}d=d.line;var l=k(d);if(null==l||null!=k(d-1))return null;for(var e=d;null!=k(e+1);)++e;return{from:b.Pos(d,l+1),to:c.clipPos(b.Pos(e))}})});
