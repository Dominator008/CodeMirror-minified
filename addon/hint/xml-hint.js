'use strict';(function(n){"object"==typeof exports&&"object"==typeof module?n(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],n):n(CodeMirror)})(function(n){function r(c,b,w){return w?0<=c.indexOf(b):0==c.lastIndexOf(b,0)}var x=n.Pos;n.registerHelper("hint","xml",function(c,b){function w(){return{list:q,from:t?x(l.line,null==A?a.start:A):l,to:t?x(l.line,a.end):l}}var d=b&&b.schemaInfo,u=b&&b.quoteChar||'"',v=b&&b.matchInMiddle;if(d){var l=c.getCursor(),
a=c.getTokenAt(l);a.end>l.ch&&(a.end=l.ch,a.string=a.string.slice(0,l.ch-a.start));b=n.innerMode(c.getMode(),a.state);if(b.mode.xmlCurrentTag){var q=[],t=!1,m=/\btag\b/.test(a.type)&&!/>$/.test(a.string),C=m&&/^\w/.test(a.string),A;if(C){var e=c.getLine(l.line).slice(Math.max(0,a.start-2),a.start);(e=/<\/$/.test(e)?"close":/<$/.test(e)?"open":null)&&(A=a.start-("close"==e?2:1))}else m&&"<"==a.string?e="open":m&&"</"==a.string&&(e="close");var B=b.mode.xmlCurrentTag(b.state);if(!m&&!B||e){if(C)var k=
a.string;t=e;var g=b.mode.xmlCurrentContext?b.mode.xmlCurrentContext(b.state):[];m=(b=g.length&&g[g.length-1])&&d[b];if((g=b?m&&m.children:d["!top"])&&"close"!=e)for(c=0;c<g.length;++c)k&&!r(g[c],k,v)||q.push("<"+g[c]);else if("close"!=e)for(var f in d)!d.hasOwnProperty(f)||"!top"==f||"!attrs"==f||k&&!r(f,k,v)||q.push("<"+f);b&&(!k||"close"==e&&r(b,k,v))&&q.push("</"+b+">")}else{f=(m=B&&d[B.name])&&m.attrs;d=d["!attrs"];if(!f&&!d)return;if(!f)f=d;else if(d){e={};for(var h in d)d.hasOwnProperty(h)&&
(e[h]=d[h]);for(h in f)f.hasOwnProperty(h)&&(e[h]=f[h]);f=e}if("string"==a.type||"="==a.string){d=function(y){if(y)for(var z=0;z<y.length;++z)k&&!r(y[z],k,v)||q.push(u+y[z]+u);return w()};e=c.getRange(x(l.line,Math.max(0,l.ch-60)),x(l.line,"string"==a.type?a.start:a.end));h=e.match(/([^\s\u00a0=<>"']+)=$/);if(!h||!f.hasOwnProperty(h[1])||!(g=f[h[1]]))return;"function"==typeof g&&(g=g.call(this,c));if("string"==a.type){k=a.string;h=0;/['"]/.test(a.string.charAt(0))&&(u=a.string.charAt(0),k=a.string.slice(1),
h++);var p=a.string.length;/['"]/.test(a.string.charAt(p-1))&&(u=a.string.charAt(p-1),k=a.string.substr(h,p-2));h&&(c=c.getLine(l.line),c.length>a.end&&c.charAt(a.end)==u&&a.end++);t=!0}return g&&g.then?g.then(d):d(g)}"attribute"==a.type&&(k=a.string,t=!0);for(p in f)!f.hasOwnProperty(p)||k&&!r(p,k,v)||q.push(p)}return w()}}})});
